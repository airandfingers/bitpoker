function onKeyDown(e){e.preventDefault()}function Table(){self=this,this.events={},this.imageData={maxChipsPerColumn:5,distanceBetweenChipColumns:4,chatBoxAlpha:.75,maxChipColumns:3,numberOfPlayersSet:!1},this.sessionPreferences={changeUserSeatViewTo:{value:!1,updateValue:function(e){this.value=e,self.changeUserSeatView(this.value)}},tableChatFull:{defaultItemsToHideFalseHidesItem:{hideDealerMessages:{value:!0},hideDealerMessagesOn:{value:!1},hidePlayerMessages:{value:!0},hidePlayerMessagesOn:{value:!1},hideObserverMessages:{value:!0},hideObserverMessagesOn:{value:!1},disableTouchScroll:{value:!0},disableTouchScrollOn:{value:!1}}}},this.permanentPreferences={bigBlindsPerHorizontalSliderTick:{value:.5},bigBlindsPerMouseScroll:{value:.5},timePerHorizontalSliderTick:{value:500},animate:{value:!0},playerChatMaxLines:{value:3},chatTextColor:{value:"#000000",updateValue:function(e){this.value=e;for(var s=0;s<self.images.seats.length;s++)self.images.seats[s].chat.text.color=this.value;self.updateStages(self.images.seats[s].chat.position.z.stage)}},tableChatFull:{chatMessageFontSize:{value:11,updateValue:function(e){this.value=e,self.jQueryObjects.tableChatFullParagraph.css("font-size",this.value)}},chatMessageFontColor:{value:"white",updateValue:function(e){this.value=e,self.jQueryObjects.tableChatFullParagraph.css("color",this.value)}},windowColor:{value:"black"},windowAlpha:{value:.4,updateValue:function(e){this.value=e,self.images.tableChatFull.window.alpha=this.value}}}},this.performance={},this.performance.numCanvasClears=0,this.gameState={},this.gameState.defaulttimeToActInMS=15e3,this.gameState.numSeats=10,this.gameState.tableChatFull={log:[],lastDisplayedLogIDNumber:null,currentlyDisplayingDealerMessages:null,currentlyDisplayingPlayerMessages:null,currentlyDisplayingObserverMessages:null,scrollToBasedOnHiddenPixelsAtTopOfChatMessageText:99999999,mouseDown:!1},this.gameState.betSize=new Number,this.gameState.displaySize="normal",this.gameState.secondsToAct,this.gameState.userSeatNumber=!1,this.gameState.seats=[];for(var i=0;i<this.gameState.numSeats;i++)this.gameState.seats[i]={},this.gameState.seats[i].displayMessageType="openSeat",this.gameState.seats[i].toAct=!1,this.gameState.seats[i].preActions={},this.gameState.seats[i].preActions.once={},this.gameState.seats[i].preActions.street={},this.gameState.seats[i].preActions.hand={},this.gameState.seats[i].flags={};this.gameState.cashier={},this.gameState.tableChatBox={},this.gameState.messageBox={},this.gameState.messageBox.activeStages=[];var staticItems=0,holeCards=staticItems+1,buttons=holeCards+1,middleTableItemsAndAnimations=buttons+1,playerBubbleChat=middleTableItemsAndAnimations+1,chatBox=playerBubbleChat+1,tableChatFull=chatBox+1,cashier=tableChatFull+1,messageBox=cashier+1,loadingContainers=messageBox+1;this.gameState.zPositionData={containersPerCashier:3,tableChatFullTotalContainers:5,containersPerMessageBox:3,numContainers:55},this.gameState.zPositionData.background={stage:staticItems,container:0,numContainers:2,stageOptions:{mouseEnabled:!1,enableDOMEvents:!1,mouseOverFrequency:0,touchEnabled:!1}},this.gameState.zPositionData.table={stage:staticItems,container:1},this.gameState.zPositionData.holeCards={stage:holeCards,container:0,newCanvas:!0,numContainers:2,stageOptions:this.gameState.zPositionData.background.stageOptions},this.gameState.zPositionData.button={stage:buttons,container:0,numContainers:3,stageOptions:{mouseEnabled:!0,enableDOMEvents:!0,touchEnabled:!0,mouseMoveOutside:!0}},this.gameState.zPositionData.playerBubbleChat={stage:playerBubbleChat,container:0,numContainers:2,stageOptions:this.gameState.zPositionData.background.stageOptions},this.gameState.zPositionData.communityCards={stage:middleTableItemsAndAnimations,container:0,numContainers:5,stageOptions:this.gameState.zPositionData.background.stageOptions},this.gameState.zPositionData.chips={stage:middleTableItemsAndAnimations,container:1},this.gameState.zPositionData.cardAnimation={stage:middleTableItemsAndAnimations,container:2},this.gameState.zPositionData.chat={stage:chatBox,container:0,numContainers:1,stageOptions:this.gameState.zPositionData.background.stageOptions},this.gameState.zPositionData.cashier={stage:cashier,container:0,canvasHidden:!0,numContainers:2,newCanvas:!0,stageOptions:this.gameState.zPositionData.button.stageOptions},this.gameState.zPositionData.initialMessageBox={stage:messageBox,container:0,canvasHidden:!0,numContainers:32,newCanvas:!0,stageOptions:this.gameState.zPositionData.button.stageOptions},this.gameState.zPositionData.finalMessageBox={stage:messageBox,container:29},this.gameState.zPositionData.loadingBackground={stage:loadingContainers,container:0,numContainers:3,newCanvas:!0,stageOptions:this.gameState.zPositionData.background.stageOptions},this.gameState.zPositionData.loadingAnimation={stage:loadingContainers,container:1},this.gameState.zPositionData.tableChatFull={stage:tableChatFull,container:0,canvasHidden:!0,newCanvas:!0,numContainers:4,stageOptions:this.gameState.zPositionData.button.stageOptions},this.gameState.zPositionData.tableChatFullButton={stage:tableChatFull,container:3},this.gameState.zPositionData.tableChatFullText={stage:tableChatFull,container:1},this.jQueryObjects={},this.jQueryObjects.canvasDiv=$("#pokerCanvasDiv"),this.jQueryObjects.tableChatFullDiv=$("#tableChatFullTextDiv"),this.jQueryObjects.tableChatFullParagraph=$("#tableChatFullText"),this.jQueryObjects.chatBoxInput=$("#chat"),this.jQueryObjects.cashierForm=$("#cashier"),this.gameState.stageData=[],this.arrayOfParentsOfStageAndOfContainerArray=[],this.images={},this.images.sources={hiddenCardFileName:"back.png",background:"img/gray_bg.jpg",table:"img/table.png",dealerButton:"img/dealer_button_red.png",verticalSlider:"img/raise_slider.png",horizontalSlider:"img/small_slider_bg.png",cashierBackground:"img/cashier_background.png",cashierCloseX:"img/cashier_close_window_x.jpg",cashierButton:"img/cashier.png",cashierButtonOver:"img/cashier_over.png",cashierButtonPress:"img/cashier_press.png",cashierButtonSprite:"img/cashier_button_sprite.png",getChips:"img/get_chips.png",showTableChatFull:"img/show_chat.png",hideTableChatFull:"img/hide_chat.png",standUp:"img/stand_up.png",exitTable:"img/exit_table.png",messageBoxBackground:"img/message_box.png",messageBoxCloseX:"img/message_box_close_window_x.jpg",checkBox:"img/check_box.png",checkBoxChecked:"img/check_box_clicked.png",dealHoleCardSound:"sound/deal_hole_card.wav",checkSound:"sound/check.wav",betSound:"sound/bet.wav",shuffleSound:"sound/shuffle.wav",dealCommunity:"sound/deal_community.wav",foldSound:"sound/fold.wav",moveChipsSound:"sound/move_chips.wav",chips:{red:"img/chips/red_chip.png",black:"img/chips/black_chip.png",10:"img/chips/10.png"}},this.images.sources.cardImageFolder="mobile"==this.gameState.displaySize?"img/fourcolordeck/resize/":"img/fourcolordeck/",this.images.background={},this.images.pots=[];for(var i=0;9>i;i++)this.images.pots[i]={},this.images.pots[i].potSize={text:{}},this.images.pots[i].chips=[],this.images.pots[i].firstChip={},this.images.pots[i].secondChip={},this.images.pots[i].secondColumnChip={};this.images.totalPotSize={},this.images.fold={text:{},messages:[]},this.images.call={text:{},messages:[]},this.images.bet={text:{},messages:[]},this.images.raise={text:{},messages:[]},this.images.bet={text:{},messages:[]},this.images.check={text:{},messages:[]},this.images.betSlider={},this.images.cashier={},this.images.messageBox=[];for(var i=0;i<=this.gameState.zPositionData.finalMessageBox;i++)this.images.messageBox.push({});this.images.community=[{},{},{},{},{}],this.images.leftSideButtons=[],this.images.rightSideButtons=[];for(var i=0;3>i;i+=1)this.images.leftSideButtons[i]={},this.images.rightSideButtons[i]={};this.images.seats=[];for(var i=0;i<this.gameState.numSeats;i+=1)this.images.seats[i]={},this.images.seats[i].nonRotatedSeatNumber=i,this.images.seats[i].originalSeatNumber=i,this.images.seats[i].rotatedSeatNumber=i,this.images.seats[i].seat={},this.images.seats[i].text={},this.images.seats[i].bet={},this.images.seats[i].chips=[],this.images.seats[i].firstChip={},this.images.seats[i].secondChip={},this.images.seats[i].secondColumnChip={},this.images.seats[i].messages=[],this.images.seats[i].hiddenCard0={},this.images.seats[i].hiddenCard1={},this.images.seats[i].shownCard0={},this.images.seats[i].shownCard1={},this.images.seats[i].dealerButton={};this.images.Item=function(e,s,t,a,i,n){if(this.position={},this.position.x=Math.floor(e),this.position.y=Math.floor(s),this.position.z={},!_.isObject(i))throw"z data not given for Item constructor";if(_.isObject(i))this.position.z=i;else if(_.isNumber(i)&&i>=0)for(var l=0;i>=l;l++)for(var o=0;o<self.arrayOfParentsOfStageAndOfContainerArray.length;o++)l+self.arrayOfParentsOfStageAndOfContainerArray[o].containers.length<i?l+=self.arrayOfParentsOfStageAndOfContainerArray[o].containers.length:(this.position.z.stage=o,this.position.z.container=i-l);this.size={},this.size.x=t,this.size.y=a,n&&(n.messages&&(this.messages=n.messages),n.otherMessages&&(this.otherMessages=n.otherMessages)),this.drawRoundedRectangle=function(e){this.image.graphics.beginFill(e).drawRoundRect(0,0,this.size.x,this.size.y,.1*this.size.y)}},this.images.itemAsBitmap=function(e,s){var t=new Image;t.src=s,e.image=new createjs.Bitmap(t),self.positionItemImage(e,{update:!1}),e.image.parentOfImageObject=e,e.bitmapSource=s,e.messages&&(e.image.onClick=self.events.onButtonClick)},this.images.cardAsBitmap=function(e,s){if(new Image,_.isString(s))var t=this.sources.cardImageFolder+s+".png";else var t=this.sources.cardImageFolder+hiddenCardFileName+".png";this.itemAsBitmap(e,t)},this.images.itemAsRectangle=function(e,s){e.image=new createjs.Shape,self.positionItemImage(e,{update:!1}),e.drawRoundedRectangle(s),e.image.parentOfImageObject=e,e.fillColor=s,e.messages&&(e.image.onClick=self.events.onButtonClick)},this.images.drawSeat=function(e,s,t,a,i){if(e.image instanceof createjs.Shape||(e.image=new createjs.Shape,e.image.parentOfImageObject=e),i&&i.outerStrokeWidth)var n=i.outerStrokeWidth;else var n=4;if(i&&i.middleDividerStrokeWidth)var l=i.middleDividerStrokeWidth;else var l=1;var o=n/2,r=n/2,h=e.size.x-n,g=e.size.y-n;if(e.image.graphics.clear(),e.image.alpha=1,e.image.snapToPixel=!0,e.image.graphics.setStrokeStyle(n,"square").beginStroke(s).beginFill(t).drawRect(o,r,h,g),i&&i.borderFillRatio&&_.isNumber(i.borderFillRatio)&&i.borderFillRatio>0){if(i&&i.newFillColor)var m=i.newFillColor;else m="#FFFF00";e.image.graphics.setStrokeStyle(n,"square").beginStroke(m);var d=2*h+2*g,f=i.borderFillRatio*d;e.image.graphics.moveTo(o,r),f>=g?(e.image.graphics.lineTo(o,r+g),f-=g):f>0&&(e.image.graphics.lineTo(o,r+f),f=0),f>=h?(e.image.graphics.lineTo(o+h,r+g),f-=h):f>0&&(e.image.graphics.lineTo(o+f,r+g),f=0),f>=g?(e.image.graphics.lineTo(o+h,r),f-=g):f>0&&(e.image.graphics.lineTo(o+h,r+g-f),f=0),f>=h?(e.image.graphics.lineTo(o,r),f-=h):f>0&&(e.image.graphics.lineTo(o+h-f,r),f=0)}e.image.graphics.setStrokeStyle(l).beginStroke(a),e.image.borderColor=s,e.image.fillColor=t,e.image.middleDividerColor=a,e.image.outerStrokeWidth=n,e.image.middleDividerStrokeWidth=l,self.positionItemImage(e,{update:!1});var c=e.position.z.stage,u=e.position.z.container;return self.arrayOfParentsOfStageAndOfContainerArray[c].containers[u].contains(e.image)&&(self.arrayOfParentsOfStageAndOfContainerArray[c].upToDate=!1),c},this.images.addItemText=function(e,s,t,a){e.text=new createjs.Text(s,t,a),e.text.x=e.position.x+e.size.x/2,e.text.y=e.position.y+2,e.text.baseline="top",e.text.textAlign="center",e.text.maxWidth=.9*e.size.x,e.textColor=a},this.events.buttonMouseDown=function(e){e.target instanceof createjs.Shape&&(e.target.graphics.clear(),e.target.graphics.beginFill("red").drawRoundRect(0,0,e.target.parentOfImageObject.size.x,e.target.parentOfImageObject.size.y,.15*e.target.parentOfImageObject.size.y),e.target.parentOfImageObject.text.y=e.target.parentOfImageObject.text.y+2,self.updateStages(e.target.parentOfImageObject.position.z.stage),e.onMouseUp=function(e){e.target.graphics.clear(),e.target.graphics.beginFill(e.target.parentOfImageObject.fillColor).drawRoundRect(0,0,e.target.parentOfImageObject.size.x,e.target.parentOfImageObject.size.y,.15*e.target.parentOfImageObject.size.y),e.target.parentOfImageObject.text.y=e.target.parentOfImageObject.text.y-2,self.updateStages(e.target.parentOfImageObject.position.z.stage)})},this.events.onButtonClick=function(e){console.log("button clicked"),e.target.parentOfImageObject.messages&&socket.emit.apply(socket,e.target.parentOfImageObject.messages),e.target.parentOfImageObject.otherMessages&&socket.emit.apply(socket,e.target.parentOfImageObject.otherMessages)},this.events.foldToAnyBetClick=function(){socket.emit("set flag","fold",!0),socket.emit("set flag","check",!0)},this.events.foldToAnyBetOnClick=function(){socket.emit("set flag","fold",!1),socket.emit("set flag","check",!1)},this.events.cashierTextFieldFocused=function(e){$(e.target).one("mouseup",function(e){e.preventDefault()}).select()},this.events.cashierInputSelected=function(e){var s,t=$(e.target.parentElement.parentElement).find("input[type='radio']"),a=!1;if("otherAmountDiv"==e.target.parentElement.id?(s=self.gameState.cashier.min,a=e.target.parentElement.id):"autoRebuyDiv"==e.target.parentElement.id?(s=self.gameState.cashier.table_min,a=e.target.parentElement.id):"maxDiv"==e.target.parentElement.id&&(s=self.gameState.cashier.max,a=e.target.parentElement.id),a){var i=$("#"+a).find("input[type='radio']");i&&0==i.prop("checked")&&(t.prop("checked",!1),i.prop("checked",!0));var n=$(e.target.parentElement).find("input[type='text']"),l=!1;"number"==typeof parseFloat(n.val())&&parseFloat(n.val())>=s||(n.val(s),n.select(),l=!0),console.log(n),$(e.target).is("input[type='text']")||1!=l&&n.select()}},this.events.onCashierTextFieldFocus=function(e){$(e.target).one("mouseup",function(e){e.preventDefault()}).select()},this.events.onAddChipsClick=function(){if($("#maxRadio").is(":checked"))socket.emit("add_chips",self.gameState.cashier.max,self.gameState.cashier.currency);else if($("#otherAmountRadio").is(":checked")){var e=$("#otherAmount").val();if(isNaN(e)){var s={};s.okay=!0;var t="amount must be a number";self.displayMessageBox(t,s)}else socket.emit("add_chips",Number(e),self.gameState.cashier.currency)}else if($("#autoRebuyRadio").is(":checked")){var e=$("#autoRebuy").val();if(isNaN(otherAmount)){var s={};s.okay=!0;var t="Amount must be a number";self.displayMessageBox(t,s)}else socket.emit("auto_rebuy",Number(e),self.gameState.cashier.currency)}else if(!$("input[name='addChipsRadio']:checked").val()){var s={};s.okay=!0;var t="Please select either: max, other amount, or auto-rebuy";self.displayMessageBox(t,s)}},this.events.onStagePress=function(){$(":text").blur()},this.events.showTableChatFullOnClick=function(){console.log("show clicked"),self.displayTableChatFull(),$("#chatForm").blur(),self.jQueryObjects.tableChatFullParagraph.blur()},this.events.hideTableChatFullOnClick=function(){console.log("hide"),self.hideTableChatFull()},this.moveTableChatFullMessageText=function(e){if(console.log("moveTableChatFullMessageText called"),e&&_.isNumber(e.magnitude)){if(e.positionUnit||(e.positionUnit="pixels"),e.relativity||(e.relativity="absolute"),e.magnitude||(e.magnitude=0),"pixels"==e.positionUnit,e.resize===!0)if(self.permanentPreferences.tableChatFull.scrollBarType&&"mCustomScrollbar"==self.permanentPreferences.tableChatFull.scrollBarType.value)console.log("calling update function of mcustomscrollbar"),self.jQueryObjects.tableChatFullDiv.mCustomScrollbar("update");else{var s=self.jQueryObjects.tableChatFullDiv.getNiceScroll();s[0].resize()}}else if(self.permanentPreferences.tableChatFull.scrollBarType&&"mCustomScrollbar"==self.permanentPreferences.tableChatFull.scrollBarType.value)console.log("using mcustomsrollbar function to scroll to bottom, then update"),self.jQueryObjects.tableChatFullDiv.mCustomScrollbar("scrollTo","bottom"),self.jQueryObjects.tableChatFullDiv.mCustomScrollbar("update");else{console.log("scrolling to bottom with nicescroll");var s=self.jQueryObjects.tableChatFullDiv.getNiceScroll();s[0].getContentSize().h!=self.jQueryObjects.tableChatFullDiv.height()&&(self.jQueryObjects.tableChatFullDiv.scrollTop(1.5*s[0].getContentSize().h),s[0].resize())}},this.events.tableChatFullChatMessageTextMouseDown=function(e){self.gameState.tableChatFull.mouseDown=!0,console.log("tablechatfull text clicked"),e.rawX,e.rawY},this.events.disableTouchScrollClicked=function(){console.log("disableTouchScrollClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.disableTouchScroll.value=!1,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.disableTouchScrollOn.value=!0,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.disableTouchScrollOnClicked=function(){console.log("disableTouchScrollClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.disableTouchScroll.value=!0,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.disableTouchScrollOn.value=!1,self.updateTableChatFullDisplay({update:!0})},this.events.hideDealerMessagesClicked=function(){self.getPermanentPreferences(),console.log("hideDealerMessagesClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideDealerMessages.value=!1,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideDealerMessagesOn.value=!0,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.hideDealerMessagesOnClicked=function(){console.log("hideDealerMessagesOnClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideDealerMessages.value=!0,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideDealerMessagesOn.value=!1,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.hidePlayerMessagesClicked=function(){console.log("hidePlayerMessagesClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hidePlayerMessages.value=!1,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hidePlayerMessagesOn.value=!0,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.hidePlayerMessagesOnClicked=function(){console.log("hidePlayerMessagesOnClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hidePlayerMessages.value=!0,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hidePlayerMessagesOn.value=!1,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.hideObserverMessagesClicked=function(){console.log("hideObserverMessagesClicked"),self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideObserverMessages.value=!1,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideObserverMessagesOn.value=!0,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.hideObserverMessagesOnClicked=function(){self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideObserverMessages.value=!0,self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideObserverMessagesOn.value=!1,self.saveSessionPreferences(),self.updateTableChatFullDisplay({update:!0})},this.events.rotateSeatsIfNeededAndConfirm=function(){if(self.permanentPreferences.alwaysRotate===!0,self.images.seats[self.gameState.userSeatNumber].rotatedSeatNumber!==self.sessionPreferences.changeUserSeatViewTo.value&&0!==self.images.seats[self.gameState.userSeatNumber].rotatedSeatNumber){console.log("changing userseat view");var e={};e.title="Seat Viewpoint Changed",e.okayText="OK, this is fine",e.cancelText="Change view",e.cancel=!0,e.okayEvent=function(){self.hideMessageBox(),self.sessionPreferences.changeUserSeatViewTo.value=self.images.seats[self.gameState.userSeatNumber].rotatedSeatNumber,self.saveSessionPreferences()},e.cancelEvent=function(){console.log("cancel event called"),self.images.seats[self.gameState.userSeatNumber].rotatedSeatNumber!==self.gameState.userSeatNumber?self.changeUserSeatView(self.gameState.userSeatNumber):self.changeUserSeatView(self.sessionPreferences.changeUserSeatViewTo.value)};var s="Your table viewpoint has been changed so that you appear at the bottom middle.  Your position relative to other players remains the same. Click "+e.cancelText+" to change your view back.";self.displayMessageBox(s,e)}},this.events.exitTableClick=function(){console.log("exittable clicked");var e={};e.title="Leave Table?",e.cancel=!0,e.okayEvent=function(){socket.emit("stand"),window.location.href="/lobby",self.hideMessageBox()},self.displayMessageBox("Are you sure you want to leave?",e)},this.events.viewLobbyClick=function(){var e="Lobby";window.open("/lobby",e,"width=800,height=770 ,left=200,top=200,location=0,toolbar=no,menubar=no,titlebar=no,directories=no,scrollbars=yes")},this.events.exit=function(){socket.emit("stand");var e=window.open("","_self");e.close()},this.events.wheelScroll=function(e){if(0==_.isNumber(e))return"scroll failed";var s=e*self.permanentPreferences.bigBlindsPerMouseScroll.value*self.gameState.bigBlind,t=parseFloat($("#betSize").val()),a=!isNaN(t)&&_.isNumber(t);if(1==a)var i=s+t;else var i=s+self.gameState.betSize;i=self.returnRoundedDownBetSize(i),self.adjustBetDisplay(i)},this.events.betSliderHorizontalMouseDown=function(e){var s=self.images.betSlider.horizontal.position.x,t=self.images.betSlider.horizontal.position.x+self.images.betSlider.horizontal.size.x-self.images.betSlider.vertical.size.x,a=self.gameState.bigBlind*self.permanentPreferences.bigBlindsPerHorizontalSliderTick.value/(self.gameState.maxBet-self.gameState.minBet)*(t-s),i=function(){betSizePercent=(self.images.betSlider.vertical.image.x-s)/(t-s),unroundedBetAmount=betSizePercent*(self.gameState.maxBet-self.gameState.minBet)+self.gameState.minBet,roundedBet=Math.round(unroundedBetAmount/self.gameState.minIncrement)*self.gameState.minIncrement,self.adjustBetDisplay(roundedBet)},n=function(e){createjs.Tween.removeTweens(self.images.betSlider.vertical.image);var l;e.stageX>self.images.betSlider.vertical.image.x+self.images.betSlider.vertical.size.x?(l=1,self.images.betSlider.vertical.image.x=self.images.betSlider.vertical.image.x+a,self.images.betSlider.vertical.image.x>t&&(self.images.betSlider.vertical.image.x=t),i()):e.stageX<self.images.betSlider.vertical.image.x?(l=-1,self.images.betSlider.vertical.image.x-a,self.images.betSlider.vertical.image.x<s&&(self.images.betSlider.vertical.image.x=s),i()):l=0,(l>0||0>l)&&createjs.Tween.get(self.images.betSlider.vertical.image,{override:!0,loop:!0}).wait(self.permanentPreferences.timePerHorizontalSliderTick.value).call(n,[e])};n(e),e.onMouseMove=function(e){n(e)},e.onMouseUp=function(){createjs.Tween.removeTweens(self.images.betSlider.vertical.image)}},this.events.betSliderVerticalMouseDown=function(e){var s,t,a=self.images.betSlider.horizontal.position.x,i=self.images.betSlider.horizontal.position.x+self.images.betSlider.horizontal.size.x-self.images.betSlider.vertical.size.x;e.onMouseMove=function(e){e.stageX>i?(e.target.x=i,s=self.gameState.maxBet):e.stageX<a?(e.target.x=a,s=self.gameState.minBet):e.stageX>=a&&e.stageX<=i&&(e.target.x=e.stageX,t=(e.stageX-a)/(i-a),unroundedBetAmount=t*(self.gameState.maxBet-self.gameState.minBet)+self.gameState.minBet,s=Math.round(unroundedBetAmount/self.gameState.minIncrement)*self.gameState.minIncrement),self.adjustBetDisplay(s)},e.onMouseUp=function(e){e.stageX>i?(e.target.x=i,s=self.gameState.maxBet):e.stageX<a?(e.target.x=a,s=self.gameState.minBet):e.stageX>=a&&e.stageX<=i&&(e.target.x=e.stageX,t=(e.stageX-a)/(i-a),unroundedBetAmount=t*(self.gameState.maxBet-self.gameState.minBet)+self.gameState.minBet,s=Math.round(unroundedBetAmount/self.gameState.minIncrement)*self.gameState.minIncrement),self.adjustBetDisplay(s)}},this.events.betSizeUnfocused=function(){console.log("betsizeunfocused called");var e,s=parseFloat($("#betSize").val()),t=!isNaN(s)&&_.isNumber(s);e=0==t?self.returnRoundedDownBetSize(self.gameState.betSize):self.returnRoundedDownBetSize(s),e>self.gameState.maxBet?e=self.gameState.maxBet:e<self.gameState.minBet&&(e=self.gameState.minBet),e!=s&&self.adjustBetDisplay(e),self.images.bet.image.onClick=self.events.onButtonClick,self.images.raise.image.onClick=self.events.onButtonClick},this.events.betSizeChanged=function(){console.log("betsize changed");var e=parseFloat($("#betSize").val()),s=/\S/.test($("#betSize").val()),t=!isNaN(e)&&_.isNumber(e),a=e!=self.gameState.betSize;if(s&&t&&a&&self.adjustBetDisplay(e),0==self.returnRoundedDownBetSize(e)||self.returnRoundedDownBetSize(e)!=e){console.log("disabling 1 click on raise/bet"),self.images.bet.image.onPress=i,self.images.raise.image.onPress=i,self.images.bet.image.onClick=null,self.images.raise.image.onClick=null;var i=function(e){e.onMouseUp=function(e){e.target.onClick=self.events.onButtonClick,e.target.onPress=self.events.buttonMouseDown}}}0!=self.returnRoundedDownBetSize(e)&&self.returnRoundedDownBetSize(e)==e&&(self.images.bet.image.onClick=self.events.onButtonClick,self.images.raise.image.onClick=self.events.onButtonClick,self.images.bet.image.onPress=self.events.buttonMouseDown,self.images.raise.image.onPress=self.events.buttonMouseDown)},this.initialize=function(){function e(e,s,i){l++,u.status.text.text=e+" loaded",u.preloadBar.drawBar(l/j),console.log(e+" loaded file id: "+s+" totalLoaded: "+l+" of "+j),s==t[t.length-1].id?console.log("last image loaded"):s==a[a.length-1].id&&console.log("last non-flash sound loaded"),self.updateStages(u.status.position.z.stage),i&&i()}function s(e,s,i){l++,o++,r.push(e),u.status.text.text=e+" loaded",console.log(e+" error loading file id: "+s+" totalLoaded: "+l+" of "+j),u.preloadBar.drawBar(l/j),s==t[t.length-1].id?console.log("last image loaded"):s==a[a.length-1].id&&console.log("last non-flash sound loaded"),l>=j&&(console.log("load completed with total of "+o+" image and sound errors whose sources are in the following array:"),console.log(r)),self.updateStages(u.status.position.z.stage),i&&i()}this.initializeStagesAndCanvasCallThisFirst();var t=[],a=[],i=[],n=0,l=0,o=0,r=[],h=function(e){var s=e.substr(e.length-4).toUpperCase();return".PNG"==s?!0:".JPG"==s?!0:!1},g=function(e){var s=e.substr(e.length-4).toUpperCase();return".MP3"==s?!0:".WAV"==s?!0:!1},m=function(e){var s=e.substr(e.length-4).toUpperCase();return".SWF"==s?!0:!1};for(var d in this.images.sources)if(_.isString(this.images.sources[d]))h(this.images.sources[d])?(t.push({src:this.images.sources[d],id:n}),n++):m(this.images.sources[d])?(i.push({src:this.images.sources[d],id:n}),n++):g(this.images.sources[d])&&(a.push({src:this.images.sources[d],id:n}),n++);else if(_.isObject(this.images.sources[d]))for(var f in this.images.sources[d])_.isString(this.images.sources[d][f])&&(t.push({src:this.images.sources[d][f],id:n}),n++);for(var d=2;14>=d;d++){var c;c=10==d?"t":11==d?"j":12==d?"q":13==d?"k":14==d?"a":d,t.push({src:this.images.sources.cardImageFolder+c+"c.png",id:n}),n++,t.push({src:this.images.sources.cardImageFolder+c+"d.png",id:n}),n++,t.push({src:this.images.sources.cardImageFolder+c+"h.png",id:n}),n++,t.push({src:this.images.sources.cardImageFolder+c+"s.png",id:n}),n++}t.push({src:this.images.sources.cardImageFolder+this.images.sources.hiddenCardFileName,id:n});var u={};console.log(this.arrayOfParentsOfStageAndOfContainerArray);var p=this.arrayOfParentsOfStageAndOfContainerArray[0].stage.canvas.width,x=this.arrayOfParentsOfStageAndOfContainerArray[0].stage.canvas.height,b="20px Arial",C=35,S=50,y="Loading resources...",v="#000000",O="15px arial",I=20,B="#000000",z=x/2,w=.65*p,A=30,F="rgb(0,0,255)",T="#000000",P="rgb(150,150,150)",k="blue";u.background=new this.images.Item(0,0,p,x,this.gameState.zPositionData.loadingBackground),u.background.image=new createjs.Shape,u.background.image.graphics.beginFill(k).drawRect(u.background.position.x,u.background.position.y,u.background.size.x,u.background.size.y),u.preloadBar=new this.images.Item(p/2-w/2,z,w,A,this.gameState.zPositionData.loadingAnimation),u.title=new this.images.Item(0,z-S-C,p,C,this.gameState.zPositionData.loadingAnimation),u.status=new this.images.Item(u.preloadBar.position.x,u.preloadBar.position.y-I,p-u.preloadBar.x,I,this.gameState.zPositionData.loadingAnimation),u.preloadBar.image=new createjs.Shape,u.preloadBar.drawBar=function(e){var s,t=u.preloadBar.size.x*e+u.preloadBar.position.x;t>=u.preloadBar.size.x+u.preloadBar.position.x?(t=u.preloadBar.size.x+u.preloadBar.position.x,s=!1):t<=u.preloadBar.position.x?(t=!1,s=u.preloadBar.position.x):s=t,u.preloadBar.image.graphics.clear().beginStroke(F).beginFill(null).setStrokeStyle(1).drawRect(u.preloadBar.position.x,u.preloadBar.position.y,u.preloadBar.size.x,u.preloadBar.size.y),0!=t&&u.preloadBar.image.graphics.setStrokeStyle(0).beginFill(T).beginStroke(null).drawRect(u.preloadBar.position.x,u.preloadBar.position.y,t-u.preloadBar.position.x,u.preloadBar.size.y),0!=s&&s<u.preloadBar.position.x+u.preloadBar.size.x&&u.preloadBar.image.graphics.setStrokeStyle(0).beginFill(P).beginStroke(null).drawRect(s,u.preloadBar.position.y,u.preloadBar.position.x+u.preloadBar.size.x-s,u.preloadBar.size.y);var a=u.preloadBar.position.z.stage,i=u.preloadBar.position.z.container;return self.arrayOfParentsOfStageAndOfContainerArray[a].containers[i].contains(u.preloadBar.image)&&(self.arrayOfParentsOfStageAndOfContainerArray[a].upToDate=!1),a},this.images.addItemText(u.title,y,b,v),u.status.text=new createjs.Text("",O,B),u.status.text.x=u.status.position.x,u.status.text.y=u.status.position.y+1,u.status.text.baseline="top",u.status.text.textAlign="left",u.status.textColor=v,this.images.imageLoading={};var C=30,b="30px Arial",v="blue",y="Displaying Images ...",D=.25*p,N=.75*x;this.images.imageLoading.title=new this.images.Item(D,N,p-D,C,this.gameState.zPositionData.loadingAnimation),this.images.imageLoading.title.text=new createjs.Text(y,b,v),this.images.imageLoading.title.text.x=this.images.imageLoading.title.position.x,this.images.imageLoading.title.text.y=this.images.imageLoading.title.position.y+1,this.images.imageLoading.title.text.baseline="top",this.images.imageLoading.title.text.textAlign="left",this.images.imageLoading.title.text.textColor=v;var M=function(){console.log(u),self.displayChildren(u,{update:!1})},j=t.length+a.length+i.length,H=function(t,a){var i=0,n=function(){i++,console.log("loaded "+i+" images out of a total of "+t.length+" images")},l=[];_.each(_.range(t.length),function(a){l[a]=new Image,"string"==typeof t[a]?l[a].src=t[a]:"object"==typeof t[a]&&(l[a].src=t[a].src),l[a].onload=function(){e(l[a].src,t[a].id,n)},l[a].onerror=function(){s(l[a].src,t[a].id,n)}});var o=setInterval(function(){i>=t.length&&(console.log("calling onComplete function"),a(),clearInterval(o))},25)},W=function(t,a){createjs.FlashPlugin.BASE_PATH="js/vendor/",createjs.Sound.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin,createjs.FlashPlugin]),createjs.Sound.addEventListener("fileload",function(s){e(s.src,s.id)}),createjs.Sound.addEventListener("error",function(e){s(e.src,e.id)}),createjs.Sound.registerManifest(a);for(var i=0;i<t.length;i++){console.log(t[i].src);var n=createjs.Sound.createInstance(t[i].src);console.log(n),n.play(),e(t[i].src,t[i].id)}};M(),H(t,function(){self.displayChildren(self.images.imageLoading.title,{update:!1}),self.createAllItems()}),W(i,a)},this.images.setDefaults=function(){$("#iframe, iframe").bind("mousewheel",function(e){console.log(e),e.preventDefault()});var e,s,t=self.arrayOfParentsOfStageAndOfContainerArray[self.gameState.zPositionData.background.stage].stage.canvas.width,a=self.arrayOfParentsOfStageAndOfContainerArray[self.gameState.zPositionData.background.stage].stage.canvas.height;this.sources.cardImageFolder.indexOf("resize")>=0?(e=36,s=44):(e=40,s=64);
var i=-e/8,n=.92,l=100,o=13,r=20,h=2,g=3,m=o,d=5,f=1,c="10px arial",u="#FFFFFF",p=80,x=25,b=205,C=419,S=20,y=90,v=33,O=40,I=123,B=77,z=153,w=z+v+I,A=371,F=27,T=t-F-y,P=t/2-y/2-y-O,k=t/2-y/2,D=k+y+O,N=t,M=15,j=3,H="bold 16px Arial",W="white",E=220,R=2,U=30,L=22,Q=-U/3,X=v+.1*L,V=y+.1*U,Y=0,q=y+U/3,G=1.1*-L,K=1.1*-U,J=0,Z=9,es=100,ss="14px Arial",ts="#FFFFFF",as=-25,is=20,ns=3,ls=7,os=20,rs=5,hs=10,gs=10,ms=135,ds=self.jQueryObjects.chatBoxInput.css("border").substring(0,self.jQueryObjects.chatBoxInput.css("border").indexOf("p")),fs=20,cs="rgb(160,0,0) ",us=6,ps=13,xs=200,bs=7,Cs=19,Ss=15,ys=80,vs=20,Os=1.4*y,Is=v/2.3,Bs=v/4,zs="#FFFFFF",ws=10,As=is,Fs=-s*n-1.5*is,Ts=y+1.5*is,Ps=is/2,ks=y-is,Ds=v+1.5*is,_s=1.5*-is,Ns=v-is/2,Ms=132,js=52,Hs=169,Ws=26,$s=10,Es=37,Rs=3,Us=3,Ls=2,Qs=150,Xs=32,Vs=25,Ys=52,qs=2,Gs=8,Ks=2,Js=153,Zs=42,et=2,st=2,tt=10,at=12,it=41,nt=2,lt=0,ot=15,rt=.43;this.dealerButton=new this.Item(0,0,U,L,self.gameState.zPositionData.chips),this.itemAsBitmap(this.dealerButton,this.sources.dealerButton),this.pots[0].firstChip=new this.Item(t/2-e/2-e,E+as,is,is,self.gameState.zPositionData.chips),this.pots[0].secondChip=new this.Item(this.pots[0].firstChip.position.x,this.pots[0].firstChip.position.y-ns,is,is,self.gameState.zPositionData.chips),this.pots[0].secondColumnChip=new this.Item(this.pots[0].firstChip.position.x+is+self.imageData.distanceBetweenChipColumns,this.pots[0].firstChip.position.y,is,is,self.gameState.zPositionData.chips),(this.pots[0].secondColumnChip.position.x-this.pots[0].firstChip.position.x)*(self.imageData.maxChipColumns-1)+is,this.pots[0].potSize=new this.Item(this.pots[0].firstChip.position.x,this.pots[0].firstChip.position.y+Z,es,Z,self.gameState.zPositionData.chips),this.addItemText(this.pots[0].potSize,"",ss,ts);var ht=(this.pots[0].secondColumnChip.position.x-this.pots[0].firstChip.position.x)*self.imageData.maxChipColumns,gt=this.pots[0].firstChip.position.y-this.pots[0].secondChip.position.y,mt=is+(self.imageData.maxChipsPerColumn-1)*gt;this.totalPotSize=new this.Item(this.pots[0].firstChip.position.x,this.pots[0].firstChip.position.y+is-mt-2*Z,es,Z,self.gameState.zPositionData.chips),this.addItemText(this.totalPotSize,"",ss,ts);for(var dt=1;dt<this.seats.length-1;dt++)this.pots[dt].firstChip=new this.Item(this.pots[0].firstChip.position.x+dt*ht,this.pots[0].firstChip.position.y,is,is,self.gameState.zPositionData.chips),this.pots[dt].secondChip=new this.Item(this.pots[0].secondChip.position.x+dt*ht,this.pots[0].secondChip.position.y,is,is,self.gameState.zPositionData.chips),this.pots[dt].secondColumnChip=new this.Item(this.pots[0].secondColumnChip.position.x+dt*ht,this.pots[0].secondColumnChip.position.y,is,is,self.gameState.zPositionData.chips),this.pots[dt].potSize=new this.Item(this.pots[0].potSize.position.x+dt*ht,this.pots[0].potSize.position.y,es,Z,self.gameState.zPositionData.chips),this.addItemText(this.pots[dt].potSize,"",ss,ts);this.htmlTableChatBox=new this.Item(hs,a-gs-fs-2*ds,ms,fs,self.gameState.zPositionData.button);var ft="Type here to chat";self.jQueryObjects.chatBoxInput.val(ft),self.jQueryObjects.chatBoxInput.css("color",cs),self.jQueryObjects.chatBoxInput.focus(function(){self.jQueryObjects.chatBoxInput.val()==ft&&(self.jQueryObjects.chatBoxInput.val(""),self.jQueryObjects.chatBoxInput.css("color",self.permanentPreferences.chatTextColor.value))}),self.jQueryObjects.chatBoxInput.focusout(function(){/\S/.test(self.jQueryObjects.chatBoxInput.val())||(self.jQueryObjects.chatBoxInput.val("Type here to chat"),self.jQueryObjects.chatBoxInput.css("color",cs))});var ct=self.arrayOfParentsOfStageAndOfContainerArray[self.images.htmlTableChatBox.position.z.stage],ut=$(ct.stage.canvas).css("z-index");$("#chatDiv").css("z-index",parseInt(ut)+1),self.jQueryObjects.chatBoxInput.css({position:"absolute",left:this.htmlTableChatBox.position.x+"px",top:this.htmlTableChatBox.position.y+"px",width:this.htmlTableChatBox.size.x+"px",height:this.htmlTableChatBox.size.y+"px",padding:"0px",margin:"0px"}),self.jQueryObjects.chatBoxInput.keypress(function(e){var s=e.keyCode?e.keyCode:e.which;"13"==s&&(socket.emit("chat",$("#chat").val()),$("#chat").val(""),self.jQueryObjects.chatBoxInput.focus())}),this.foldToAnyBet=new this.Item(h,this.htmlTableChatBox.position.y-r-3*o-2*g,l,o,self.gameState.zPositionData.button,{messages:["set_flag","check",!0],otherMessages:["set_flag","fold",!0]}),this.sitOutNextHand=new this.Item(h,this.htmlTableChatBox.position.y-r-2*o-g,l,o,self.gameState.zPositionData.button,{messages:["sit_out"]}),this.sitOutNextBlind=new this.Item(h,this.htmlTableChatBox.position.y-r-o,l,o,self.gameState.zPositionData.button,{messages:["set_flag","post_blind",!1]}),this.foldToAnyBetOn=new this.Item(this.foldToAnyBet.position.x,this.foldToAnyBet.position.y,this.foldToAnyBet.size.x,this.foldToAnyBet.size.y,self.gameState.zPositionData.button,{messages:["set_flag","fold",!1],otherMessages:["set_flag","check",!1]}),this.sitOutNextHandOn=new this.Item(this.sitOutNextHand.position.x,this.sitOutNextHand.position.y,this.sitOutNextHand.size.x,this.sitOutNextHand.size.y,self.gameState.zPositionData.button,{messages:["sit_in"]}),this.sitOutNextBlindOn=new this.Item(this.sitOutNextBlind.position.x,this.sitOutNextBlind.position.y,this.sitOutNextBlind.size.x,this.sitOutNextBlind.size.y,self.gameState.zPositionData.button,{messages:["set_flag","post_blind",!0]}),this.itemAsBitmap(this.foldToAnyBet,this.sources.checkBox),this.itemAsBitmap(this.sitOutNextHand,this.sources.checkBox),this.itemAsBitmap(this.sitOutNextBlind,this.sources.checkBox),this.itemAsBitmap(this.foldToAnyBetOn,this.sources.checkBoxChecked),this.itemAsBitmap(this.sitOutNextHandOn,this.sources.checkBoxChecked),this.itemAsBitmap(this.sitOutNextBlindOn,this.sources.checkBoxChecked);var pt=function(e){var s=self.getTextWidthAndFontSize(e)[0],t=m+d+s;e.size.x=t;var a=new createjs.Shape;return a.graphics.beginFill("#FFFFFF").beginStroke(0).drawRect(0,f,t,e.size.y-f),a},xt=function(e,s){e.text=new createjs.Text(s,c,u),e.text.x=e.position.x+m+d,e.text.y=e.position.y+1,e.text.baseline="top",e.text.textAlign="left",e.textColor=u;var t=pt(e);e.text.hitArea=t,e.image.hitArea=t};xt(this.foldToAnyBet,"Auto check/fold"),xt(this.sitOutNextHand,"Sit out next hand"),xt(this.sitOutNextBlind,"Sit out next blind"),xt(this.foldToAnyBetOn,"Auto check/fold"),xt(this.sitOutNextHandOn,"Sit out next hand"),xt(this.sitOutNextBlindOn,"Sit out next blind"),this.foldToAnyBet.image.onclick=self.events.onButtonClick,this.sitOutNextHand.image.onclick=self.events.onButtonClick,this.sitOutNextBlind.image.onclick=self.events.onButtonClick,this.foldToAnyBetOn.image.onclick=self.events.onButtonClick,this.sitOutNextHandOn.image.onclick=self.events.onButtonClick,this.sitOutNextBlindOn.image.onclick=self.events.onButtonClick,this.seats[0].seat=new this.Item(k,A,y,v,self.gameState.zPositionData.button),this.seats[1].seat=new this.Item(P,A,y,v,self.gameState.zPositionData.button),this.seats[2].seat=new this.Item(F,w,y,v,self.gameState.zPositionData.button),this.seats[3].seat=new this.Item(F,z,y,v,self.gameState.zPositionData.button),this.seats[4].seat=new this.Item(P,B,y,v,self.gameState.zPositionData.button),this.seats[5].seat=new this.Item(k,B,y,v,self.gameState.zPositionData.button),this.seats[6].seat=new this.Item(D,B,y,v,self.gameState.zPositionData.button),this.seats[7].seat=new this.Item(T,z,y,v,self.gameState.zPositionData.button),this.seats[8].seat=new this.Item(T,w,y,v,self.gameState.zPositionData.button),this.seats[9].seat=new this.Item(D,A,y,v,self.gameState.zPositionData.button),_.each(_.range(this.seats.length),function(e){self.images.seats[e].seat.position.x,self.images.seats[e].seat.position.y,self.images.seats[e].seat.size.x,self.images.seats[e].seat.size.y,self.images.seats[e].seat.image=new createjs.Shape,self.images.seats[e].seat.image.parentOfImageObject=self.images.seats[e].seat});for(var dt=0;dt<this.seats.length;dt++){self.images.drawSeat(this.seats[dt].seat,"#000000","#000000","#7d7d7d"),this.seats[dt].openSeat=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y,self.gameState.zPositionData.button),this.seats[dt].disabledSeat=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y,self.gameState.zPositionData.button),this.seats[dt].action=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y/2,self.gameState.zPositionData.button),this.seats[dt].countdown=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y/2,self.gameState.zPositionData.button),this.seats[dt].winner=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y/2,self.gameState.zPositionData.button),this.seats[dt].playerName=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y/2,self.gameState.zPositionData.button),this.seats[dt].status=new this.Item(this.seats[dt].seat.position.x,this.seats[dt].seat.position.y+this.seats[dt].seat.size.y/2,this.seats[dt].seat.size.x,this.seats[dt].seat.size.y/2,self.gameState.zPositionData.button);var bt=this.seats[dt].seat.position.x+this.seats[dt].seat.size.x/2,Ct=bt-e-i/2,St=this.seats[dt].seat.position.y-s*n,yt=bt+i/2;this.seats[dt].hiddenCard0=new this.Item(Ct,St,e,s,self.gameState.zPositionData.holeCards),this.seats[dt].hiddenCard1=new this.Item(yt,St,e,s,self.gameState.zPositionData.holeCards),this.seats[dt].shownCard0=new this.Item(Ct,St,e,s,self.gameState.zPositionData.holeCards),this.seats[dt].shownCard1=new this.Item(yt,St,e,s,self.gameState.zPositionData.holeCards);var vt="#000000",Ot=Ot,It="#FFFFFF";self.images.drawSeat(this.seats[dt].openSeat,It,vt,Ot,{outerStrokeWidth:nt}),this.seats[dt].openSeat.image.parentOfImageObject=this.seats[dt].openSeat,this.seats[dt].openSeat.text=new createjs.Text("Open Seat","15px Arial","#FFFFFF"),this.seats[dt].openSeat.text.x=this.seats[dt].openSeat.position.x+this.seats[dt].openSeat.size.x/2,this.seats[dt].openSeat.text.y=this.seats[dt].openSeat.position.y+4,this.seats[dt].openSeat.text.baseline="top",this.seats[dt].openSeat.text.textAlign="center",this.seats[dt].openSeat.text.maxWidth=.9*this.seats[dt].openSeat.size.x,this.seats[dt].openSeat.textColor="#FFFFFF";var Bt="#544E4F",zt="black",wt=zt;self.images.drawSeat(this.seats[dt].disabledSeat,Bt,zt,wt,{outerStrokeWidth:nt}),this.seats[dt].disabledSeat.image.parentOfImageObject=this.seats[dt].disabledSeat,this.itemAsBitmap(this.seats[dt].hiddenCard0,this.sources.cardImageFolder+this.sources.hiddenCardFileName),this.itemAsBitmap(this.seats[dt].hiddenCard1,this.sources.cardImageFolder+this.sources.hiddenCardFileName),this.addItemText(this.seats[dt].shownCard0,"","12px Arial","#000000"),this.addItemText(this.seats[dt].shownCard1,"","12px Arial","#000000"),this.addItemText(this.seats[dt].playerName,"","11px arial","#FFFFFF"),this.addItemText(this.seats[dt].status,"","11px arial","#FFFFFF"),this.addItemText(this.seats[dt].action,"","11px Arial","#FFFFFF"),this.addItemText(this.seats[dt].countdown,"","11px Arial","#FFFFFF"),this.addItemText(this.seats[dt].winner,"","11px Arial","#FFFFFF");var At=1.1;if(this.seats[dt].seat.position.y<B+At&&this.seats[dt].seat.position.y>B-At){var Ft=this.seats[dt].seat.position.x+Q,Tt=this.seats[dt].seat.position.y+X;this.seats[dt].dealerButton=new this.Item(Ft,Tt,U,L,self.gameState.zPositionData.chips),this.seats[dt].firstChip=new this.Item(this.seats[dt].seat.position.x+ks,this.seats[dt].seat.position.y+Ds,is,is,self.gameState.zPositionData.chips),this.seats[dt].secondColumnChip=new this.Item(this.seats[dt].firstChip.position.x-is-self.imageData.distanceBetweenChipColumns,this.seats[dt].firstChip.position.y,is,is,self.gameState.zPositionData.chips);var ns=this.pots[0].secondChip.position.y-this.pots[0].firstChip.position.y,Pt=this.seats[dt].firstChip.position.x,kt=this.seats[dt].firstChip.position.y+ns*(self.imageData.maxChipsPerColumn-1),Dt=Pt+os+rs,_t=kt;this.seats[dt].bet=new this.Item(Dt,_t,os,ls,self.gameState.zPositionData.chips)}else if(this.seats[dt].seat.position.x<F+At&&this.seats[dt].seat.position.x>F-At){var Ft=this.seats[dt].seat.position.x+V,Tt=this.seats[dt].seat.position.y+Y;this.seats[dt].dealerButton=new this.Item(Ft,Tt,U,L,self.gameState.zPositionData.chips),this.seats[dt].firstChip=new this.Item(this.seats[dt].seat.position.x+Ts,this.seats[dt].seat.position.y+Ps,is,is,self.gameState.zPositionData.chips),this.seats[dt].secondColumnChip=new this.Item(this.seats[dt].firstChip.position.x+is+self.imageData.distanceBetweenChipColumns,this.seats[dt].firstChip.position.y,is,is,self.gameState.zPositionData.chips);var ns=this.pots[0].secondChip.position.y-this.pots[0].firstChip.position.y,Nt=this.seats[dt].firstChip.position.x;this.seats[dt].firstChip.position.y;var Dt=Nt,_t=this.seats[dt].firstChip.position.y+ns*(self.imageData.maxChipsPerColumn-1)-ls-rs;this.seats[dt].bet=new this.Item(Dt,_t,os,ls,self.gameState.zPositionData.chips)}else if(this.seats[dt].seat.position.y<A+At&&this.seats[dt].seat.position.y>A-At){this.seats[dt].firstChip=new this.Item(this.seats[dt].seat.position.x+As,this.seats[dt].seat.position.y+Fs,is,is,self.gameState.zPositionData.chips),this.seats[dt].secondColumnChip=new this.Item(this.seats[dt].firstChip.position.x+is+self.imageData.distanceBetweenChipColumns,this.seats[dt].firstChip.position.y,is,is,self.gameState.zPositionData.chips);var Mt=this.seats[dt].firstChip.position.x,jt=this.seats[dt].firstChip.position.y,Dt=Mt-os-rs,_t=jt,Ft=this.seats[dt].seat.position.x+q,Tt=this.seats[dt].seat.position.y+G;this.seats[dt].dealerButton=new this.Item(Ft,Tt,U,L,self.gameState.zPositionData.chips),this.seats[dt].bet=new this.Item(Dt,_t,os,ls,self.gameState.zPositionData.chips)}else if(this.seats[dt].seat.position.x<T+At&&this.seats[dt].seat.position.x>T-At){var Ft=this.seats[dt].seat.position.x+K,Tt=this.seats[dt].seat.position.y+J;this.seats[dt].dealerButton=new this.Item(Ft,Tt,U,L,self.gameState.zPositionData.chips),this.seats[dt].firstChip=new this.Item(this.seats[dt].seat.position.x+_s,this.seats[dt].seat.position.y+Ns,is,is,self.gameState.zPositionData.chips),this.seats[dt].secondColumnChip=new this.Item(this.seats[dt].firstChip.position.x-is-self.imageData.distanceBetweenChipColumns,this.seats[dt].firstChip.position.y,is,is,self.gameState.zPositionData.chips);var Ht=this.seats[dt].firstChip.position.x,Wt=this.seats[dt].firstChip.position.y,Dt=Ht,_t=Wt+is+ls;this.seats[dt].bet=new this.Item(Dt,_t,os,ls,self.gameState.zPositionData.chips)}var ns=this.pots[0].secondChip.position.y-this.pots[0].firstChip.position.y;this.seats[dt].secondChip=new this.Item(this.seats[dt].firstChip.position.x,this.seats[dt].firstChip.position.y+ns,is,is,self.gameState.zPositionData.chips),this.addItemText(this.seats[dt].bet,"","12px Arial","#FFFFFF"),this.seats[dt].dealerButton instanceof this.Item?this.itemAsBitmap(this.seats[dt].dealerButton,this.sources.dealerButton):console.log(dt+" is not a seat")}_.each(_.range(this.seats.length),function(e){var s=self.images.seats[e].seat.position.x+self.images.seats[e].seat.size.x/2-Os/2,t=self.images.seats[e].seat.position.y-Bs;self.images.seats[e].chat=new self.images.Item(s,t,Os,Is,self.gameState.zPositionData.playerBubbleChat),self.images.seats[e].chat.image=new createjs.Shape,self.images.seats[e].chat.image.drawChat=function(s,t){if(void 0==s)var s=self.images.seats[e].chat.size.x;else s>self.images.seats[e].chat.size.x&&(s=self.images.seats[e].chat.size.x);self.images.seats[e].chat.image.graphics.clear(),self.images.seats[e].chat.image.parentOfImageObject=self.images.seats[e].chat;var a=(self.images.seats[e].chat.size.x-s)/2,i=0;self.images.seats[e].chat.image.snapToPixel=!0,self.images.seats[e].chat.image.graphics.setStrokeStyle(1,"round").beginStroke(zs).beginFill("#000000").drawRoundRect(a,i-(t-1)*(ws+1),s,self.images.seats[e].chat.size.y+(t-1)*(ws+1),.16*self.images.seats[e].chat.size.y),self.images.seats[e].chat.image.alpha=self.imageData.chatBoxAlpha,self.positionItemImage(self.images.seats[e].chat,{update:!1})},self.images.seats[e].chat.text=new createjs.Text("",ws+"px Arial","#FFFFFF"),self.images.seats[e].chat.text.x=self.images.seats[e].chat.position.x+self.images.seats[e].chat.size.x/2,self.images.seats[e].chat.text.y=self.images.seats[e].chat.position.y,self.images.seats[e].chat.text.baseline="top",self.images.seats[e].chat.text.textAlign="center",self.images.seats[e].chat.text.lineWidth=.85*self.images.seats[e].chat.size.x}),_.each(_.range(this.seats.length),function(e){_.each(self.images.seats[e],function(s,t){self.images.seats[e][t].parentOfItem=self.images.seats[e]})}),this.fold=new this.Item(b,C,p,x,self.gameState.zPositionData.button,{messages:["act","fold"]}),this.call=new this.Item(b+p+S,C,p,x,self.gameState.zPositionData.button,{messages:["act","call"]}),this.check=new this.Item(b+p+S,C,p,x,self.gameState.zPositionData.button,{messages:["act","check"]}),this.raise=new this.Item(this.check.position.x+p+S,C,p,x,self.gameState.zPositionData.button,{messages:["act","raise"]}),this.bet=new this.Item(this.check.position.x+p+S,C,p,x,self.gameState.zPositionData.button,{messages:["act","bet"]}),this.itemAsRectangle(this.fold,"red"),this.addItemText(this.fold,"fold","12px Arial","#000000"),this.itemAsRectangle(this.call,"red"),this.addItemText(this.call,"call","12px Arial","#000000"),this.itemAsRectangle(this.check,"red"),this.addItemText(this.check,"check","12px Arial","#000000"),this.itemAsRectangle(this.raise,"red"),this.addItemText(this.raise,"raise","12px Arial","#000000"),this.itemAsRectangle(this.bet,"red"),this.addItemText(this.bet,"bet","12px Arial","#000000"),this.fold.image.onClick=self.events.onButtonClick,this.call.image.onClick=self.events.onButtonClick,this.check.image.onClick=self.events.onButtonClick,this.raise.image.onClick=self.events.onButtonClick,this.bet.image.onClick=self.events.onButtonClick,this.betSlider.horizontal=new this.Item(this.fold.position.x,a-Cs-bs,xs,bs,self.gameState.zPositionData.button);var $t=this.betSlider.horizontal.position.y+this.betSlider.horizontal.size.y/2-ps/2;this.betSlider.vertical=new this.Item(this.betSlider.horizontal.position.x,$t,us,ps,self.gameState.zPositionData.button);var Et=this.betSlider.horizontal.position.x+this.betSlider.horizontal.size.x+Ss,Rt=this.betSlider.horizontal.position.y+this.betSlider.horizontal.size.y/2-vs/2;this.betSlider.betSize=new this.Item(Et,Rt,ys,vs,self.gameState.zPositionData.button),this.itemAsBitmap(this.betSlider.horizontal,this.sources.horizontalSlider),this.itemAsBitmap(this.betSlider.vertical,this.sources.verticalSlider),this.betSlider.betSize.image=document.getElementById("betSize"),self.updateBetSize("");var Ut=self.arrayOfParentsOfStageAndOfContainerArray[self.images.betSlider.vertical.position.z.stage],Lt=$(Ut.stage.canvas).css("z-index");$("#betSizeDiv").css("z-index",parseInt(Lt)+1),$("#betSize").focus(function(){$("#betSize").one("mouseup",function(e){e.preventDefault()}).select()}),$("#betSize").focusout(function(e){self.events.betSizeUnfocused(e)}),$("#betSize").change(function(){self.events.betSizeChanged()}),$("#betSize").keyup(function(){self.events.betSizeChanged()}),$("#betSize").bind("paste",function(){self.events.betSizeChanged()}),$("#betSize")[0].oninput=function(){self.events.betSizeChanged()},$("#betSize").css({position:"absolute",left:this.betSlider.betSize.position.x+"px",top:this.betSlider.betSize.position.y+"px",width:this.betSlider.betSize.size.x+"px",height:this.betSlider.betSize.size.y+"px",padding:"0px",margin:"0px"}),this.community[0]=new this.Item(t/2-e/2-2*e-2*R,E,e,s,self.gameState.zPositionData.communityCards),this.community[1]=new this.Item(t/2-e/2-e-R,E,e,s,self.gameState.zPositionData.communityCards),this.community[2]=new this.Item(t/2-e/2,E,e,s,self.gameState.zPositionData.communityCards),this.community[3]=new this.Item(t/2+e/2+R,E,e,s,self.gameState.zPositionData.communityCards),this.community[4]=new this.Item(t/2+e/2+e+2*R,E,e,s,self.gameState.zPositionData.communityCards),this.startingCard=new this.Item(t/2-this.community[0].size.x/2,this.community[0].position.y+this.community[0].size.y+40,e,s,self.gameState.zPositionData.cardAnimation),this.cashierButton=new this.Item(t-80,0,Ms,js,self.gameState.zPositionData.button),{images:[this.sources.cashierButtonSprite],frames:{width:80,height:31},animations:{mouseOut:0,mouseOver:1,mouseDown:2}},this.standUp=new this.Item(t-Hs,0,Hs,Ws,self.gameState.zPositionData.button,{messages:["stand"]}),this.itemAsBitmap(this.standUp,this.sources.standUp);var Qt=new createjs.Shape,Xt=Rs,Vt=this.standUp.size.y-Us;Qt.graphics.beginFill("#000000").setStrokeStyle(0).moveTo($s,Xt).lineTo(Es,Vt).lineTo(this.standUp.size.x-Ls,Vt).lineTo(this.standUp.size.x-Ls,Xt).lineTo($s,Xt),this.standUp.image.hitArea=Qt,this.standUpDisabledShape=new this.Item(this.standUp.position.x+$s,this.standUp.position.y+Xt,this.standUp.size.x-$s-Ls,this.standUp.size.y-Xt-Vt,{container:self.gameState.zPositionData.button.container,stage:self.gameState.zPositionData.button.stage+1}),this.standUpDisabledShape.image=Qt.clone(!0),this.standUpDisabledShape.image.x=this.standUp.position.x,this.standUpDisabledShape.image.y=this.standUp.position.y,this.standUpDisabledShape.image.alpha=rt,this.getChips=new this.Item(0,0,Js,Zs,self.gameState.zPositionData.button,{messages:["get_add_chips_info"]}),this.itemAsBitmap(this.getChips,this.sources.getChips);var Yt={x:et,y:st},qt={x:Yt.x,y:this.getChips.size.y-tt},Gt={x:this.getChips.size.x-at,y:st},Kt={x:this.getChips.size.x-it,y:qt.y},Jt=new createjs.Shape;Jt.graphics.beginFill("#000000").beginStroke(0).moveTo(Yt.x,Yt.y).lineTo(qt.x,qt.y).lineTo(Kt.x,Kt.y).lineTo(Gt.x,Gt.y).closePath,this.getChips.image.hitArea=Jt,this.getChipsDisabledShape=new this.Item(Yt.x,Yt.y,Gt.x-Yt.x,Kt.y-Yt.y,{container:self.gameState.zPositionData.button.container,stage:self.gameState.zPositionData.button.stage+1}),this.getChipsDisabledShape.image=Jt,this.getChipsDisabledShape.image.alpha=rt,this.exitTable=new this.Item(t-Qs,Ws,Qs,Xs,self.gameState.zPositionData.button),this.itemAsBitmap(this.exitTable,this.sources.exitTable);var Zt=new createjs.Shape;Zt.graphics.beginStroke(0).beginFill("#000000").moveTo(this.exitTable.size.x-Ks,qs).lineTo(this.exitTable.size.x-Ks,this.exitTable.size.y-Gs).lineTo(Ys,this.exitTable.size.y-Gs).lineTo(Vs,qs).lineTo(this.exitTable.size.x-Ks,qs),this.exitTable.image.hitArea=Zt,this.exitTable.image.onClick=self.events.exitTableClick,this.sitIn=new this.Item(b,C,p,x,self.gameState.zPositionData.button,{messages:["sit_in"]}),this.rebuy=new this.Item(b,C,p,x,self.gameState.zPositionData.button,{messages:["get_add_chips_info"]}),this.itemAsRectangle(this.sitIn,"black"),this.addItemText(this.sitIn,"Deal Me In","10px Arial","white"),this.itemAsRectangle(this.rebuy,"black"),this.addItemText(this.rebuy,"Get Chips","10px Arial","white"),this.sitIn.image.onClick=self.events.onButtonClick,this.rebuy.image.onClick=self.events.onButtonClick;var ea=t/2-N/2;this.currencyDisplay=new this.Item(ea,j,N,M,self.gameState.zPositionData.button),this.addItemText(this.currencyDisplay,"",H,W),{images:[this.sources.fourColorDeck],frames:{width:37,height:45}};for(var sa=self.gameState.zPositionData.containersPerMessageBox,ta=self.gameState.zPositionData.initialMessageBox.stage,aa=self.gameState.zPositionData.initialMessageBox.container;aa<=self.gameState.zPositionData.finalMessageBox.container-sa;aa+=sa){for(var ia=aa;aa+sa>ia;ia++)self.images.messageBox[ia]={};self.images.messageBox[aa].window=new self.images.Item(0,0,0,0,{stage:ta,container:aa}),self.images.itemAsBitmap(self.images.messageBox[aa].window,self.images.sources.messageBoxBackground),self.images.messageBox[aa].closeWindow=new self.images.Item(0,0,0,0,{stage:ta,container:aa}),self.images.itemAsBitmap(self.images.messageBox[aa].closeWindow,self.images.sources.messageBoxCloseX)}$(self.arrayOfParentsOfStageAndOfContainerArray[this.messageBox[0].window.position.z.stage].stage.canvas).css("display","none"),this.table=new this.Item(lt,ot,t,a,self.gameState.zPositionData.table),this.itemAsBitmap(this.table,this.sources.table);var na=self.gameState.zPositionData.cashier.container,la=self.gameState.zPositionData.cashier.stage,oa=0,ra=298,ha=360,ga=13,ma=4,da=136,fa=13,ca=5,ua="12px arial",pa="#000000",xa=31,ba=8,Ca=8,Sa=2,ya=10,va=t/2-ra/2,Oa=a/2-ha/2,Ia=31,Ba=20,za=Oa+1,wa=va+ra-Ia-7,Aa=va+Ca,Fa=Oa+xa,Ta=ra-2*Ca-2,Pa=Aa+ga,ka=135,Da=23,_a=1.8,Na=15,Ma=fa*_a,ja=Ta-Da-ka,Ha=_a*ca,Wa=19.5,$a=13,Ea=$a,Ra=6,Ua=151,La=ka-$a-Ra-Wa,Qa=11,Ua=150,Xa=49;this.cashier.window=new this.Item(va,Oa,ra,ha,{stage:la,container:oa}),this.itemAsBitmap(this.cashier.window,this.sources.cashierBackground);for(var Va=[],Ya=[],qa=[],dt=0;ya>dt;dt++)qa.push(Oa+xa+ma+dt*(fa+ca));for(var dt=0;Sa>dt;dt++)0==dt%Sa?Va.push(va+Ca+ga):1==dt%Sa&&Va.push(va+ra-Ca-da);for(var dt=0;Sa>dt;dt++)0==dt%Sa?Ya.push(Va[(dt+1)%Sa]-Va[dt]):1==dt%Sa&&Va.push(va+ra-Ca-Va[dt]);var Ga={};Ga.currency={name:"currency",location:[0,0]},Ga.blinds={name:"blinds",location:[1,0]},Ga.tableName={name:"tableName",location:[0,1],text:"Table Name:"},Ga.tableNameValue={name:"tableNameValue",location:[1,1]},Ga.tableMin={name:"tableMin",location:[0,2],text:"Table Minimum:"},Ga.tableMinValue={name:"tableMinValue",location:[1,2]},Ga.tableMax={name:"tableMax",location:[0,3],text:"Table Maximum:"},Ga.tableMaxValue={name:"tableMaxValue",location:[1,3]},Ga.playerMin={name:"playerMin",location:[0,4],text:"Minimum Add-On:"},Ga.playerMinValue={name:"playerMinValue",location:[1,4]},Ga.accountBalance={name:"accountBalance",location:[0,5],text:"Available Balance:"},Ga.accountBalanceValue={name:"accountBalanceValue",location:[1,5]},Ga.autoRebuy={name:"autoRebuy",location:[0,6],text:"Auto-Rebuy:"},Ga.autoRebuyValue={name:"autoRebuyValue",location:[1,6]},$(self.arrayOfParentsOfStageAndOfContainerArray[self.images.cashier.window.position.z.stage].stage.canvas).css("display","none"),$("#cashier input[type='text']").css("width",ja+"px"),$("#cashier input[type='text']").css("height",Ma+"px"),$("#cashier").children().children().css({font:ua}),$("#cashier input[type='radio']").css({background:"rgb(233,233,233)","background-image":"img/radio_button_bg.jpg","background-repeat":"repeat","-webkit-backface-visibility":"hidden"}),$("#cashier p").css({"max-width":La+"px",height:Ma+"px","white-space":"nowrap"});var Ka=Aa+Wa,Ja=Fa+Ua+Na,Za=Aa+ka,ei=Ja+Ma/2-Ea/2,Pa=Ka+$a+Ra,si=self.arrayOfParentsOfStageAndOfContainerArray[self.images.cashier.window.position.z.stage],ti=parseInt($(si.stage.canvas).css("z-index"));$("#cashierDiv").css("z-index",parseInt(ti)+1),$("#maxRadio").css("left",Ka+"px"),$("#maxRadio").css("top",ei+"px"),$("#maxText").css("left",Pa+"px"),$("#maxText").css("top",ei+"px"),$("#maxAmount").css("left",Za+"px"),$("#maxAmount").css("top",Ja+"px");var ai=Ja+Ma+Ha,ii=ai+Ma/2-Ea/2;$("#otherAmountRadio").css("left",Ka+"px"),$("#otherAmountRadio").css("top",ii+"px"),$("#otherAmountText").css("left",Pa+"px"),$("#otherAmountText").css("top",ii+"px"),$("#otherAmount").css("left",Za+"px"),$("#otherAmount").css("top",ai+"px");var ni=ai+Ma+Ha,li=ni+Ma/2-Ea/2;$("#autoRebuyRadio").css("left",Ka+"px"),$("#autoRebuyRadio").css("top",li+"px"),$("#autoRebuyText").css("left",Pa+"px"),$("#autoRebuyText").css("top",li+"px"),$("#autoRebuyAmount").css("left",Za+"px"),$("#autoRebuyAmount").css("top",ni+"px");for(var dt in Ga)if(_.isArray(Ga[dt].location)){if(this.cashier[Ga[dt].name]=new this.Item(Va[Ga[dt].location[0]],qa[Ga[dt].location[1]],Ya[0],fa,{stage:la,container:na}),Ga[dt].text)var oi=Ga[dt].text;else var oi="";this.cashier[Ga[dt].name].text=new createjs.Text(oi,ua,pa),this.cashier[Ga[dt].name].text.x=this.cashier[Ga[dt].name].position.x,this.cashier[Ga[dt].name].text.y=this.cashier[Ga[dt].name].position.y+1,this.cashier[Ga[dt].name].text.baseline="top",this.cashier[Ga[dt].name].text.textAlign="left",this.cashier[Ga[dt].name].text.maxWidth=.9*this.cashier[Ga[dt].name].size.x}var ri=va+Ca+Qa,hi=Oa+xa+Ua,gi=ra-2*Ca-2*Qa,mi=Oa+ha-ba-Xa-hi;this.cashier.grayBox=new this.Item(ri,hi,gi,mi,{stage:la,container:na}),this.cashier.addChipsTextBox=new this.Item(Pa,this.cashier.accountBalance.position.y+25,Ta,25,{stage:la,container:na}),this.cashier.addChips=new this.Item(va+10,Oa+ha-40,50,25,{stage:la,container:na}),this.itemAsRectangle(this.cashier.addChips,"#0000FF"),this.addItemText(this.cashier.addChips,"add chips","13px arial","#FFFFFF"),this.cashier.addChips.image.onClick=self.events.onAddChipsClick,this.cashier.cancel=new this.Item(va+100,Oa+ha-40,50,25,{stage:la,container:na}),this.itemAsRectangle(this.cashier.cancel,"#0000FF"),this.addItemText(this.cashier.cancel,"cancel","13px arial","#FFFFFF"),this.cashier.cancel.image.onClick=self.hideCashier,this.cashier.closeWindow=new this.Item(wa,za,Ia,Ba,{stage:la,container:na}),this.itemAsBitmap(this.cashier.closeWindow,this.sources.cashierCloseX),this.cashier.closeWindow.image.onClick=self.hideCashier;var di=112,fi=34,ci=-6,ui=1,pi=1,xi=7,bi=2,Ci=27;this.showTableChatFull=new this.Item(this.getChips.position.x,this.getChips.position.y+this.getChips.size.y+ci,di,fi,self.gameState.zPositionData.button),this.itemAsBitmap(this.showTableChatFull,this.sources.showTableChatFull),this.showTableChatFull.image.onClick=self.events.showTableChatFullOnClick,this.hideTableChatFull=new this.Item(this.getChips.position.x,this.getChips.position.y+this.getChips.size.y+ci,di,fi,self.gameState.zPositionData.button),this.itemAsBitmap(this.hideTableChatFull,this.sources.hideTableChatFull),this.hideTableChatFull.image.onClick=self.events.hideTableChatFullOnClick;var Si=new createjs.Shape;Si.graphics.beginStroke(0).beginFill("#000000").moveTo(ui,pi).lineTo(ui,fi-xi).lineTo(di-Ci,fi-xi).lineTo(di-bi,pi).lineTo(ui,pi),this.showTableChatFull.image.hitArea=Si,this.hideTableChatFull.image.hitArea=Si;var yi=5,vi=4,Oi=5,Ii=10;this.tableChatFull={};var Bi=yi,zi=vi+this.hideTableChatFull.position.y+this.hideTableChatFull.size.y,wi=this.seats[0].seat.position.x-Bi-Ii,Ai=this.foldToAnyBet.position.y-Oi-zi;this.tableChatFull.htmlStageElement=new this.Item(Bi,zi,wi,Ai,self.gameState.zPositionData.tableChatFull);var Fi=self.arrayOfParentsOfStageAndOfContainerArray[this.tableChatFull.htmlStageElement.position.z.stage].stage.canvas;$(Fi).attr({width:this.tableChatFull.htmlStageElement.size.x+"px",height:this.tableChatFull.htmlStageElement.size.y+"px"}),$(Fi).css({display:"none",left:this.tableChatFull.htmlStageElement.position.x+"px",top:this.tableChatFull.htmlStageElement.position.y+"px"});var Ti=self.permanentPreferences.tableChatFull.windowColor.value,Pi="#000000",ki=1,Di=self.permanentPreferences.tableChatFull.windowAlpha.value,_i=.05;this.tableChatFull.window=new this.Item(0,0,wi,Ai,self.gameState.zPositionData.tableChatFull),this.tableChatFull.window.image=new createjs.Shape,this.tableChatFull.window.image.graphics.beginFill(Ti).setStrokeStyle(ki,"round").beginStroke(Pi).drawRoundRect(this.tableChatFull.window.position.x,this.tableChatFull.window.position.y,this.tableChatFull.window.size.x,this.tableChatFull.window.size.y,_i*this.tableChatFull.window.size.y),this.tableChatFull.window.image.alpha=Di;var Ni=.05*this.tableChatFull.htmlStageElement.size.x,Mi=Ni,ji=g;this.tableChatFull.hideDealerMessages=new this.Item(Ni,ji,this.tableChatFull.window.size.x-2*h,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.hideDealerMessages,this.sources.checkBox),xt(this.tableChatFull.hideDealerMessages,"Hide dealer messages"),this.tableChatFull.hideDealerMessages.image.onClick=self.events.hideDealerMessagesClicked,this.tableChatFull.hideDealerMessagesOn=new this.Item(Ni,this.tableChatFull.hideDealerMessages.position.y,this.tableChatFull.hideDealerMessages.size.x,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.hideDealerMessagesOn,this.sources.checkBoxChecked),xt(this.tableChatFull.hideDealerMessagesOn,"Hide dealer messages"),this.tableChatFull.hideDealerMessagesOn.image.onClick=self.events.hideDealerMessagesOnClicked,this.tableChatFull.hidePlayerMessages=new this.Item(Ni,2*ji+o,this.tableChatFull.hideDealerMessages.size.x,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.hidePlayerMessages,this.sources.checkBox),xt(this.tableChatFull.hidePlayerMessages,"Hide player messages"),this.tableChatFull.hidePlayerMessages.image.onClick=self.events.hidePlayerMessagesClicked,this.tableChatFull.hidePlayerMessagesOn=new this.Item(Ni,this.tableChatFull.hidePlayerMessages.position.y,this.tableChatFull.hideDealerMessages.size.x,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.hidePlayerMessagesOn,this.sources.checkBoxChecked),xt(this.tableChatFull.hidePlayerMessagesOn,"Hide player messages"),this.tableChatFull.hidePlayerMessagesOn.image.onClick=self.events.hidePlayerMessagesOnClicked,this.tableChatFull.hideObserverMessages=new this.Item(Ni,3*g+2*o,this.tableChatFull.hideDealerMessages.size.x,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.hideObserverMessages,this.sources.checkBox),xt(this.tableChatFull.hideObserverMessages,"Hide observer messages"),this.tableChatFull.hideObserverMessages.image.onClick=self.events.hideObserverMessagesClicked,this.tableChatFull.hideObserverMessagesOn=new this.Item(Ni,this.tableChatFull.hideObserverMessages.position.y,this.tableChatFull.hideDealerMessages.size.x,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.hideObserverMessagesOn,this.sources.checkBoxChecked),xt(this.tableChatFull.hideObserverMessagesOn,"Hide observer messages"),this.tableChatFull.hideObserverMessagesOn.image.onClick=self.events.hideObserverMessagesOnClicked;
var Hi=this.tableChatFull.hideObserverMessages.size.x;this.tableChatFull.hidePlayerMessages.size.x>Hi&&(Hi=this.tableChatFull.hidePlayerMessages.size.x),this.tableChatFull.hideDealerMessages.size.x>Hi&&(Hi=this.tableChatFull.hidePlayerMessages.size.x);var Wi=this.tableChatFull.hideDealerMessages.position.x+Hi+Mi,$i=this.tableChatFull.hideDealerMessages.position.y;this.tableChatFull.disableTouchScroll=new this.Item(Wi,$i,0,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.disableTouchScroll,this.sources.checkBox),xt(this.tableChatFull.disableTouchScroll,"Disable touch scroll"),this.tableChatFull.disableTouchScroll.image.onClick=self.events.disableTouchScrollClicked,this.tableChatFull.disableTouchScrollOn=new this.Item(this.tableChatFull.disableTouchScroll.position.x,this.tableChatFull.disableTouchScroll.position.y,this.tableChatFull.disableTouchScroll.size.x,o,self.gameState.zPositionData.tableChatFullText),this.itemAsBitmap(this.tableChatFull.disableTouchScrollOn,this.sources.checkBoxChecked),xt(this.tableChatFull.disableTouchScrollOn,"Disable touch scroll"),this.tableChatFull.disableTouchScrollOn.image.onClick=self.events.disableTouchScrollOnClicked;var Ei=h-1,Ri=h-1,Ui=3,Li=this.tableChatFull.window.size.y*_i,Qi=this.tableChatFull.htmlStageElement.position.x+Ei,Xi=this.tableChatFull.htmlStageElement.position.y+this.tableChatFull.hideObserverMessages.position.y+this.tableChatFull.hideObserverMessages.size.y+Ui,Vi=this.tableChatFull.htmlStageElement.size.x-Ei-Ri,Yi=this.tableChatFull.htmlStageElement.size.y-Li-(Xi-this.tableChatFull.htmlStageElement.position.y);this.tableChatFull.htmlChatStageElement=new this.Item(Qi,Xi,Vi,Yi,self.gameState.zPositionData.tableChatFull);var qi=self.arrayOfParentsOfStageAndOfContainerArray[this.tableChatFull.htmlChatStageElement.position.z.stage],Gi=$(qi.stage.canvas).css("z-index");self.jQueryObjects.tableChatFullDiv.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",display:"none",left:this.tableChatFull.htmlChatStageElement.position.x+"px",top:this.tableChatFull.htmlChatStageElement.position.y+"px",width:this.tableChatFull.htmlChatStageElement.size.x+"px",height:this.tableChatFull.htmlChatStageElement.size.y+"px","z-index":parseInt(Gi)+1});var Ki=1,Ji=0,Zi=0,en=0,sn=en;this.tableChatFull.chatMessageText=new this.Item(Ji,en,Vi-Ji-Zi,Yi-en-sn,self.gameState.zPositionData.tableChatFullText);var tn=self.permanentPreferences.tableChatFull.chatMessageFontSize.value,an="arial",nn=self.permanentPreferences.tableChatFull.chatMessageFontColor.value;this.tableChatFull.chatMessageText.text=document.getElementById("tableChatFullTextDiv");var ln={cursorwidth:3,cursorborderwidth:Ki+"px solid #FFF",enablescrollonselection:!1,horizrailenabled:!1,hwacceleration:!1,bouncescroll:!1,cursoropacitymax:self.permanentPreferences.tableChatFull.windowAlpha.value,autohidemode:!1,touchbehavior:!0,zindex:parseInt(Gi)+1,background:"transparent"},on={theme:"light",updateOnContentResize:!0,scrollButtons:{enable:!0},callbacks:{onScrollStart:function(){console.log("scrolling started")}},set_height:this.tableChatFull.htmlChatStageElement.size.y,horizontalScroll:!1};self.permanentPreferences.tableChatFull.scrollBarType&&"mCustomScrollbar"==self.permanentPreferences.tableChatFull.scrollBarType.value?(console.log("creating mCustomScrollbar"),self.jQueryObjects.tableChatFullDiv.mCustomScrollbar(on)):$("#tableChatFullTextDiv").niceScroll(ln),self.jQueryObjects.tableChatFullParagraph.css({width:this.tableChatFull.chatMessageText.size.x+"px",height:this.tableChatFull.chatMessageText.size.y+"px",font:an,"font-size":tn+"px",color:nn,"text-overflow":"auto",top:this.tableChatFull.chatMessageText.position.y+"px",left:this.tableChatFull.chatMessageText.position.x+"px"}),console.log(this.tableChatFull.chatMessageText),console.log("all createjs images have been created")},this.createStage=function(e){var s=function(e){if(!e)var e={};if(e.stageOptions||(e.stageOptions={}),_.isNumber(e.stage))var s=e.stage;else var s=self.arrayOfParentsOfStageAndOfContainerArray.length-1;var t=e.stageOptions;if(self.arrayOfParentsOfStageAndOfContainerArray[s].stage.autoClear=!1,self.arrayOfParentsOfStageAndOfContainerArray[s].stage.snapToPixel=!1,self.arrayOfParentsOfStageAndOfContainerArray[s].stage.snapToPixelEnabled=!1,t&&(t.touchEnabled===!0&&createjs.Touch.enable(self.arrayOfParentsOfStageAndOfContainerArray[s].stage),_.isNull(t.mouseEnabled)||_.isUndefined(t.mouseEnabled)||(self.arrayOfParentsOfStageAndOfContainerArray[s].stage.mouseEnabled=t.mouseEnabled),_.isNull(t.mouseMoveOutside)||_.isUndefined(t.mouseMoveOutside)||(self.arrayOfParentsOfStageAndOfContainerArray[s].stage.mouseMoveOutside=t.mouseMoveOutside),_.isNumber(t.mouseOverFrequency)&&self.arrayOfParentsOfStageAndOfContainerArray[s].stage.enableMouseOver(t.mouseOverFrequency),_.isNull(t.enableDOMEvents)||_.isUndefined(t.enableDOMEvents)||self.arrayOfParentsOfStageAndOfContainerArray[s].stage.enableDOMEvents(t.enableDOMEvents)),e.canvasHidden===!0&&$(self.arrayOfParentsOfStageAndOfContainerArray[s].stage.canvas).css("display","none"),_.isNumber(e.numContainers)){var a=e.numContainers;_.isArray(self.arrayOfParentsOfStageAndOfContainerArray[s].containers)||(self.arrayOfParentsOfStageAndOfContainerArray[s].containers=[]);for(var i=0;a>i;i++)self.arrayOfParentsOfStageAndOfContainerArray[s].containers[i]=new createjs.Container,self.arrayOfParentsOfStageAndOfContainerArray[s].stage.addChild(self.arrayOfParentsOfStageAndOfContainerArray[s].containers[i])}};if(!e)var e={};if(_.isNumber(e.stage)||(e.stage=this.arrayOfParentsOfStageAndOfContainerArray.length),0===e.stage||0==this.arrayOfParentsOfStageAndOfContainerArray.length)var t=0,a=0;else{for(var i=e.stage-1;i>=0;i--)if(!_.isEmpty(this.arrayOfParentsOfStageAndOfContainerArray[i])){var n=i;i=-9999}var l=this.arrayOfParentsOfStageAndOfContainerArray[n].stage.canvas.id,t=parseFloat(l.replace("canvas",""));if(e.stage>this.arrayOfParentsOfStageAndOfContainerArray.length-1)var a=t+1;else var o=this.arrayOfParentsOfStageAndOfContainerArray[e.stage].stage.canvas.id,r=parseFloat(o.replace("canvas","")),a=(t+r)/2}if(e.newCanvas===!0||0===e.stage){var h="canvas"+a,g=690,m=480,d="pokerCanvasClass",f=10,c=3;self.jQueryObjects.canvasDiv.append("<canvas id = '"+h+"'"+"class = "+"'"+d+"'"+" width="+"'"+g+"'"+" height="+"'"+m+"'"+"></canvas>"),$("#"+h).css("z-index",parseInt(a*f)+c)}else var h="canvas"+t;self.arrayOfParentsOfStageAndOfContainerArray.splice(e.stage,0,{}),self.arrayOfParentsOfStageAndOfContainerArray[e.stage].upToDate=!0,self.arrayOfParentsOfStageAndOfContainerArray[e.stage].nickName=e.nickName;var u=document.getElementById(h);self.arrayOfParentsOfStageAndOfContainerArray[e.stage].stage=new createjs.Stage(u),s(e)},this.initializeStagesAndCanvasCallThisFirst=function(){var e=this.gameState.zPositionData,s=[];_.each(e,function(t,a){0===e[a].container&&(s[e[a].stage]=e[a],s[e[a].stage].nickName=a)},this),console.log(s),_.each(_.range(s.length),function(e){self.createStage(s[e])})},this.setBackground=function(){var e=this.arrayOfParentsOfStageAndOfContainerArray[this.gameState.zPositionData.background.stage].stage.canvas.height,s=this.arrayOfParentsOfStageAndOfContainerArray[this.gameState.zPositionData.background.stage].stage.canvas.width;this.images.background=new this.images.Item(0,0,s,e,this.gameState.zPositionData.background),this.images.itemAsBitmap(this.images.background,this.images.sources.background),this.displayChildren(this.images.background)},this.images.setDefaultEvents=function(){this.betSlider.vertical.image.onPress=self.events.betSliderVerticalMouseDown,this.betSlider.horizontal.image.onPress=self.events.betSliderHorizontalMouseDown;for(var e=0;e<this.seats.length;e+=1)this.seats[e].openSeat.image.onClick=function(e){_.isArray(e.target.parentOfImageObject.messages)?e.target.parentOfImageObject.messages.splice(0):e.target.parentOfImageObject.messages=[],e.target.parentOfImageObject.messages.push("sit",e.target.parentOfImageObject.parentOfItem.rotatedSeatNumber),self.events.onButtonClick(e)}},this.images.setDefaultMessages=function(){},this.createAllItems=function(){this.setBackground(),this.images.setDefaults(),this.receiveTableState(),this.images.setDefaultEvents(),this.images.setDefaultMessages(),this.displayTableChatBox(),console.log("this.create all items finished")},this.returnRoundedDownBetSize=function(e){if(e>self.gameState.maxBet)return self.gameState.maxBet;if(e<self.gameState.minBet)return self.gameState.minBet;var s,t=!isNaN(e)&&_.isNumber(e);return 0==t?!1:s=Math.floor(e/self.gameState.minIncrement)*self.gameState.minIncrement},this.playerPutsChipsInPot=function(e,s,t){s>0?(this.images.seats[e].bet.text.text=s,this.displayChildren(this.images.seats[e].bet)):(this.images.seats[e].bet.text.text="",this.hideChildren(this.images.seats[e].bet)),!_.isNull(t)&&!_.isUndefined(t)&&0>=t&&(t="All In"),this.images.seats[e].status.text.text=t},this.hideAllBets=function(e){if(!e)var e={};var s=e.update;e.update=!1;for(var t=[],a=0;a<this.images.seats.length;a+=1)t.push(this.hideBet(a,e));return e.update=s,s===!1?t:(this.updateStages(t),void 0)},this.images.rotateSeats=function(){},this.displayTableChatBox=function(){self.jQueryObjects.chatBoxInput.css({display:"inline"})},this.positionItemImage=function(e,s){_.isObject(e.image)&&(e.image.x=e.position.x,e.image.y=e.position.y),_.isObject(s)&&s.update!==!1&&this.updateStages(e.position.z.stage)},this.getStringWidth=function(e,s){var t=self.arrayOfParentsOfStageAndOfContainerArray[0].stage.canvas.getContext("2d");t.font=s;var a=t.measureText(e);return a.width},this.disableTableChatBox=function(){self.jQueryObjects.chatBoxInput.attr("readonly",!0)},this.enableTableChatBox=function(){self.jQueryObjects.chatBoxInput.attr("readonly",!1)},this.hideTableChatBox=function(){self.jQueryObjects.chatBoxInput.attr("display",none)},this.getSeatImageIndex=function(e,s){if(!_.isString(s))var s="originalSeatNumber";for(var t=0;t<self.images.seats.length;t++)if(self.images.seats[t][s]==e)return t},this.copyItemDisplayObjectLocationData=function(e){var s={};return e.image&&(s.image={},s.image.x=e.image.x,s.image.y=e.image.y),e.text&&(s.text={},s.text.x=e.text.x,s.text.y=e.text.y),e instanceof self.images.Item&&(s.position={},s.size={},s.position.x=e.position.x,s.position.y=e.position.y,s.size.x=e.size.x,s.size.y=e.size.y),s},this.setDisplayObjectLocationsInItemAEqualToOnesInItemB=function(e,s){e.image&&s.image&&(e.image.x=s.image.x,e.image.y=s.image.y),e.text&&s.text&&(e.text.x=s.text.x,e.text.y=s.text.y),e.position.x=s.position.x,e.position.y=s.position.y,e.size.x=s.size.x,e.size.y=s.size.y},this.changeUserSeatView=function(e){if(console.log("changing userseat view to seatNumberToRotateTo "+e),!_.isNumber(e))var e=0;if(e>this.gameState.numSeats)return"seatNumber too high, invalid";console.log("rotating to seat: "+e),console.log(this.images.seats);for(var s,t=[],a=0;a<this.gameState.numSeats;a++)t.push({});if(s=_.isNumber(self.gameState.userSeatNumber)?e>=self.gameState.userSeatNumber?e-self.gameState.userSeatNumber:this.gameState.numSeats-self.gameState.userSeatNumber+e:this.gameState.numSeats-this.images.seats[0].rotatedSeatNumber,s===this.images.seats[0].rotatedSeatNumber)return"no rotation";for(var a=0;a<this.gameState.numSeats;a++)_.each(this.images.seats[a],function(e,s){self.images.seats[a][s]instanceof self.images.Item&&(t[self.images.seats[a].rotatedSeatNumber][s]=self.copyItemDisplayObjectLocationData(self.images.seats[a][s]))},this);for(var a=0;a<this.gameState.numSeats;a++)this.images.seats[a].rotatedSeatNumber=(a+s)%this.gameState.numSeats,_.each(this.images.seats[a],function(e,i){self.images.seats[a][i]instanceof self.images.Item&&self.setDisplayObjectLocationsInItemAEqualToOnesInItemB(this.images.seats[a][i],t[(a+s)%this.gameState.numSeats][i])},this);this.updateStages(this.images.seats[0].seat.position.z.stage)},this.setNumberOfSeats=function(e){var s=function(e,s){if(_.isString(s))var t=self.getSeatImageIndex(e,s);else var t=e;self.images.seats[t].rotatedSeatNumber=!1,self.images.seats[t].nonRotatedSeatNumber=!1,self.images.seats.move(t,1,self.images.seats.length-1)},t=function(){var e=3*self.images.seats[0].seat.size.x+2*(self.images.seats[0].seat.position.x-self.images.seats[1].seat.position.x-self.images.seats[1].seat.size.x),s=(e-2*self.images.seats[0].seat.size.x)/6;for(var t in self.images.seats[1])self.images.seats[1][t]instanceof self.images.Item&&(self.images.seats[1][t].position.x=self.images.seats[1][t].position.x+s,self.images.seats[1][t].image&&(self.images.seats[1][t].image.x=self.images.seats[1][t].image.x+s),self.images.seats[1][t].text&&(self.images.seats[1][t].text.x=self.images.seats[1][t].text.x+s));for(var t in self.images.seats[4])self.images.seats[4][t]instanceof self.images.Item&&(self.images.seats[4][t].position.x=self.images.seats[4][t].position.x+s,self.images.seats[4][t].image&&(self.images.seats[4][t].image.x=self.images.seats[4][t].image.x+s),self.images.seats[4][t].text&&(self.images.seats[4][t].text.x=self.images.seats[4][t].text.x+s));for(var t in self.images.seats[6])self.images.seats[6][t]instanceof self.images.Item&&(self.images.seats[6][t].position.x=self.images.seats[6][t].position.x-s,self.images.seats[6][t].image&&(self.images.seats[6][t].image.x=self.images.seats[6][t].image.x-s),self.images.seats[6][t].text&&(self.images.seats[6][t].text.x=self.images.seats[6][t].text.x-s));for(var t in self.images.seats[9])self.images.seats[9][t]instanceof self.images.Item&&(self.images.seats[9][t].position.x=self.images.seats[9][t].position.x-s,self.images.seats[9][t].image&&(self.images.seats[9][t].image.x=self.images.seats[9][t].image.x-s),self.images.seats[9][t].text&&(self.images.seats[9][t].text.x=self.images.seats[9][t].text.x-s))},a=function(){console.log("centering seat 2 and 8");var e=(self.images.seats[2].seat.position.y-self.images.seats[3].seat.position.y)/2;for(var s in self.images.seats[2])self.images.seats[2][s]instanceof self.images.Item&&(self.images.seats[2][s].position.y=self.images.seats[2][s].position.y-e,self.images.seats[2][s].image&&(self.images.seats[2][s].image.y=self.images.seats[2][s].position.y),self.images.seats[2][s].text&&(self.images.seats[2][s].text.y=self.images.seats[2][s].position.y),self.setDisplayObjectLocationsInItemAEqualToOnesInItemB(self.images.seats[8][s],self.images.seats[2][s]))};if(this.images.seats[0].rotatedSeatNumber!==this.images.seats[0].nonRotatedSeatNumber&&self.changeUserSeatView(),this.imageData.numberOfPlayersSet!==!0){this.imageData.originalSeatLocations=[];for(var i=0;i<this.images.seats.length;i++)this.imageData.originalSeatLocations.push(this.copyItemDisplayObjectLocationData(this.images.seats[i]))}else{for(var n=0;n<this.images.seats.length;n++)this.images.seats.push(this.images.seats.splice(this.getSeatImageIndex(n,"originalSeatNumber"),1));for(var i=0;i<this.images.seats.length;i++)this.setDisplayObjectLocationsInItemAEqualToOnesInItemB(this.images.seats[i],this.imageData.originalSeatLocations[i])}this.gameState.numSeats=e,9==e?s(5):8==e?(t(),s(5),s(0)):7==e?(s(9),s(5),s(1)):6==e?(a(),s(7),s(5),s(3),s(0)):5==e?(a(),s(9),s(7),s(6),s(3),s(1)):4==e?(a(),s(9),s(7),s(6),s(4),s(3),s(1)):3==e?(s(9),s(8),s(6),s(5),s(4),s(2),s(1)):2==e&&(a(),s(9),s(7),s(6),s(5),s(4),s(3),s(1),s(0));for(var l=0;l<this.gameState.numSeats;l++)this.images.seats[l].nonRotatedSeatNumber=l,this.images.seats[l].rotatedSeatNumber=l;this.imageData.numberOfPlayersSet=!0},this.displayShownCard=function(e,s,t){return this.images.cardAsBitmap(s,e),this.displayChildren(s,t)},this.displayHoleCards=function(e,s,t){if(!t)var t={};t.update,t.update=!1;var a=[];return this.arrayOfParentsOfStageAndOfContainerArray[this.images.seats[s].hiddenCard0.position.z.stage].stage.contains(this.images.seats[s].hiddenCard0.image)&&(this.hideChildren(this.images.seats[s].hiddenCard0,t),this.hideChildren(this.images.seats[s].hiddenCard1,t)),this.displayShownCard(e[0],this.images.seats[s].shownCard0,t),this.displayShownCard(e[1],this.images.seats[s].shownCard1,t),t.update!==!1&&this.updateStages(a),a},this.hideHoleCards=function(e,s){var t=[];return t.push(this.images.seats[e].hiddenCard0),t.push(this.images.seats[e].hiddenCard1),t.push(this.images.seats[e].shownCard0),t.push(this.images.seats[e].shownCard1),this.hideChildren(t,s)},this.updatePotSize=function(e,s){var t=!1;if("object"==typeof e&&console.log(e.length),s&&_.isNumber(s.potNumber)){if(_.isArray[e])var a=e[s.potNumber];else var a=e;this.images.pots[potNumber].text.text=a,this.displayChipStack(parseFloat(a),this.images.pots[s.potNumber],this.images.pots[s.potNumber].firstChip.position.x,this.images.pots[s.potNumber].firstChip.position.y,{update:!1})}else if(_.isNumber(e))console.log("updating only the total pot size text"),t=e;else if(_.isArray(e)&&1==e.length)t=e[0],this.images.pots[0].potSize.text.text=t,self.displayChipStack(parseFloat(t),self.images.pots[0],self.images.pots[0].firstChip.position.x,self.images.pots[0].firstChip.position.y,{update:!1});else if(_.isArray(e)&&e.length>1){for(var i=0,n=0;n<e.length;n++)i+=parseFloat(e[n]),parseFloat(e[n])!=parseFloat(this.images.pots[n].potSize.text.text)&&(this.images.pots[n].potSize.text.text=e[n],self.displayChipStack(parseFloat(e[n]),self.images.pots[n],self.images.pots[n].firstChip.position.x,self.images.pots[n].firstChip.position.y,{update:!1})),this.displayChildren(this.images.pots[n].potSize,s);t=i}_.isNumber(t)&&(this.images.totalPotSize.text.text="Pot: "+t,this.displayChildren(this.images.totalPotSize,s)),s&&s.update===!1||this.updateStages(this.images.totalPotSize.position.z.stage)},this.playerSits=function(e,s,t,a){this.gameState.seats[e].displayMessageType="seat",this.images.seats[e].playerName.text.text=s,_.isNumber(t)&&t>0?this.images.seats[e].status.text.text=t:0==t&&(this.images.seats[e].status.text.text="adding chips");var i=this.displayCorrectSeatMessage(e,a);return i},this.hideBet=function(e,s){var t=[];for(t.push(this.hideChildren(this.images.seats[e].bet,s)),t.push(this.hideChildren(this.images.seats[e].chips,s));this.images.seats[e].chips.length>0;)this.images.seats[e].chips.pop();return t},this.addChildToContainer=function(e,s,t){if(t){if(_.isNumber(t.stageNumber))var a=t.stageNumber}else var a=e.parentOfImageObject.position.z.stage;this.arrayOfParentsOfStageAndOfContainerArray[a].containers[s].addChild(e)},this.displayChipStack=function(e,s,t,a,i){if(this.hideChildren(s.chips,{update:!1}),_.isArray(s.chips))for(;s.chips.length>0;)s.chips.pop();else s.chips=[];var n=t,l=a,o=this.images.pots[0].secondChip.position.y-this.images.pots[0].firstChip.position.y,r=0,h=1,g=!1;for(i&&i.distanceBetweenColumns&&(g=i.distanceBetweenColumns),0==g&&(g=s.secondColumnChip instanceof this.images.Item&&s.firstChip instanceof this.images.Item?s.secondColumnChip.position.x-s.firstChip.position.x:this.images.pots[0].secondColumnChip.position.x-this.images.pots[0].firstChip.position.x);e>=1;)e>=1e4?(this.displayChip("10k",n,l,s,{update:!1}),l+=o,e-=1e4):e>=5e3?(this.displayChip("5k",n,l,s,{update:!1}),l+=o,e-=5e3):e>=1e3?(this.displayChip("1k",n,l,s,{update:!1}),l+=o,e-=1e3):e>=500?(this.displayChip(500,n,l,s,{update:!1}),l+=o,e-=500):e>=100?(this.displayChip(100,n,l,s,{update:!1}),l+=o,e-=100):e>=50?(this.displayChip(50,n,l,s,{update:!1}),l+=o,e-=50):e>=25?(this.displayChip(25,n,l,s,{update:!1}),l+=o,e-=25):e>=5?(this.displayChip(5,n,l,s,{update:!1}),l+=o,e-=5):e>=1&&(this.displayChip(10,n,l,s,{update:!1}),l+=o,e-=1),r++,0==r%this.imageData.maxChipsPerColumn&&(n+=g,l=a,h++,h>=this.imageData.maxChipColumns&&(e=0));(!i||i.update!==!1&&i.hidden!==!0)&&_.isArray(s.chips)&&s.chips.length>0&&s.chips[0]instanceof this.images.Item&&this.updateStages(s.chips[0].position.z.stage)},this.displayChip=function(e,s,t,a,i){var n=this.images.pots[0].firstChip.size.x;if(1e3==e?(chipColor="#CC6600",e="1k"):chipColor=500==e?"black":100==e?"yellow":50==e?"red":25==e?"green":5==e?"#F52887":"blue",10==e)var l=this.images.sources.chips["10"];else if("red"==chipColor)var l=this.images.sources.chips.black;else if("black"==chipColor)var l=this.images.sources.chips.black;else var l=this.images.sources.chips.black;a.chips.push(new this.images.Item(s,t,n,n,this.gameState.zPositionData.chips)),this.images.itemAsBitmap(a.chips[a.chips.length-1],l),a.chips[a.chips.length-1].text=new createjs.Text(e,"7px Arial","white"),a.chips[a.chips.length-1].text.x=a.chips[a.chips.length-1].position.x+a.chips[a.chips.length-1].size.x/2,a.chips[a.chips.length-1].text.y=a.chips[a.chips.length-1].position.y+4.5,a.chips[a.chips.length-1].text.baseline="top",a.chips[a.chips.length-1].text.textAlign="center",a.chips[a.chips.length-1].text.maxWidth=.8*a.chips[a.chips.length-1].size.x;for(var o=0;o<a.chips.length-1;o++)(0==o||0!=(o+1)%this.imageData.maxChipsPerColumn)&&(this.hideText(a.chips[o],{update:!1}),a.chips[o].text=null);i&&1==i.hidden||this.displayChildren(a.chips,{update:!1})},this.animateImage=function(e,s,t,a,i,n,l,o){var r=1/a,h=a-1,g=t/a,m=n-e,d=l-s,f=m*r,c=d*r;if(i.text&&i.image)var u=i.text.x-i.image.x,p=i.text.y-i.image.y;i.image?(i.image.x=e,i.image.y=s,i.text&&(i.text.x=e+u,i.text.y=s+p)):i.text&&(i.text.x=e,i.text.y=s),self.displayChildren(i);var x=0,b=setInterval(function(){i.image&&(i.image.x=i.image.x+f,i.image.y=i.image.y+c),i.text&&(i.text.x=i.text.x+f,i.text.y=i.text.y+c),self.updateStages(i.position.z.stage),x>=h?(i.image?(i.image.x=n,i.image.y=l,i.text&&(i.text.x=n+u,i.text.y=l+p)):i.text&&(i.text.x=n,i.text.y=l),self.updateStages(i.position.z.stage),clearInterval(b),o&&o()):x++},g)},this.getTextWidthAndFontSize=function(e,s){if(e instanceof this.images.Item&&!s){var t=e.text.font.indexOf("p"),a=e.text.font.indexOf("P");if(t>=a)var i=a;else if(a>t)var i=t;var s=e.text.font.substring(0,i)}var n=this.arrayOfParentsOfStageAndOfContainerArray[0].stage.canvas.getContext("2d");n.font=e.text.font;var l=n.measureText(e.text.text);return[l.width,s]},this.dealCommunity=function(e){var s=this.images.startingCard.position.x,t=this.images.startingCard.position.y,a=200,i=.2,n=1/i-1,l=createjs.Sound.createInstance(this.images.sources.dealCommunity);if(l.play(),5==e.length){var o=new this.images.Item(s,t,this.images.community[0].size.x,this.images.community[0].size.y,this.gameState.zPositionData.cardAnimation);this.images.itemAsBitmap(o,this.images.seats[0].hiddenCard0.bitmapSource),async.series([function(e){self.animateImage(s,t,a,n+1,o,self.images.community[4].position.x,self.images.community[4].position.y,function(){e(null,1)})},function(){self.displayShownCard(e[4],self.images.community[4]),self.hideChildren(o)}])}else if(4==e.length){var o=new this.images.Item(s,t,this.images.community[0].size.x,this.images.community[0].size.y,this.gameState.zPositionData.cardAnimation);this.images.itemAsBitmap(o,this.images.seats[0].hiddenCard0.bitmapSource),async.series([function(e){self.animateImage(s,t,a,n+1,o,self.images.community[3].position.x,self.images.community[3].position.y,function(){e(null,1)})},function(){self.displayShownCard(e[3],self.images.community[3]),self.hideChildren(o)}])}else if(3==e.length){var o=new self.images.Item(s,t,self.images.community[0].size.x,self.images.community[0].size.y,self.gameState.zPositionData.cardAnimation);self.images.itemAsBitmap(o,self.images.seats[0].hiddenCard0.bitmapSource),async.series([function(e){self.animateImage(s,t,a,n+1,o,self.images.community[0].position.x,self.images.community[0].position.y,function(){e(null,1)})},function(){for(var s=0;2>=s;s++)self.images.cardAsBitmap(self.images.community[s],e[s]),self.images.community[s].image.x=self.images.community[0].position.x,self.displayChildren(self.images.community[s],{update:!1});self.updateStages(self.images.community[s].position.z.stage),self.hideChildren(o),self.animateImage(self.images.community[0].position.x,self.images.community[1].position.y,a,n+1,self.images.community[1],self.images.community[1].position.x,self.images.community[1].position.y),self.animateImage(self.images.community[0].position.x,self.images.community[2].position.y,a,n+1,self.images.community[2],self.images.community[2].position.x,self.images.community[2].position.y)}])}},this.dealHoleCards=function(e,s,t){var a=this.images.startingCard.position.x,i=this.images.startingCard.position.y,n=100,l=.2,o=1/l-1,r=[],h=[],g=[],m=1;_.each(_.range(2*s.length),function(e){var l=e%s.length,d=createjs.Sound.createInstance(self.images.sources.dealHoleCardSound);g.push(function(t){d.play(),e==l?(r[e]=new self.images.Item(a,i,self.images.community[0].size.x,self.images.community[0].size.y,self.gameState.zPositionData.cardAnimation),self.images.itemAsBitmap(r[e],self.images.seats[s[l]].hiddenCard0.bitmapSource),self.animateImage(a,i,n,o+1,r[e],self.images.seats[s[l]].hiddenCard0.position.x,self.images.seats[s[l]].hiddenCard0.position.y,function(){t(null,m)})):e>l&&(h[e]=new self.images.Item(a,i,self.images.community[0].size.x,self.images.community[0].size.y,self.gameState.zPositionData.cardAnimation),self.images.itemAsBitmap(h[e],self.images.seats[s[l]].hiddenCard0.bitmapSource),self.animateImage(a,i,n,o+1,h[e],self.images.seats[s[l]].hiddenCard1.position.x,self.images.seats[s[l]].hiddenCard1.position.y,function(){t(null,m)}))}),m++,g.push(function(a){_.isNumber(self.gameState.userSeatNumber)&&s[l]==self.gameState.userSeatNumber&&t?e==l?(self.hideChildren(r[e]),self.displayShownCard(t[0],self.images.seats[s[l]].shownCard0)):e>l&&(self.hideChildren(h[e]),self.displayShownCard(t[1],self.images.seats[s[l]].shownCard1)):e==l?(self.hideChildren(r[e]),self.displayChildren(self.images.seats[s[l]].hiddenCard0)):e>l&&(self.hideChildren(h[e]),self.displayChildren(self.images.seats[s[l]].hiddenCard1)),a(null,m)})}),async.series(g)},this.playerStands=function(e){this.gameState.seats[e].displayMessageType="openSeat",e===this.gameState.userSeatNumber&&(this.hideSeatedOptions(),this.gameState.userSeatNumber=null);for(var s=0;s<this.images.seats.length;s++)this.displayCorrectSeatMessage(s)},this.hideSeatedOptions=function(){this.hideChildren(this.images.rebuy),this.hideChildren(this.images.sitIn)},this.adjustBetDisplay=function(e){var s=self.images.betSlider.horizontal.position.x,t=self.images.betSlider.horizontal.position.x+self.images.betSlider.horizontal.size.x-self.images.betSlider.vertical.size.x,a=(e-self.gameState.minBet)/(self.gameState.maxBet-self.gameState.minBet),i=(t-s)*a+s;i>=t?(i=t,self.images.bet.text.text="Bet All-In",self.images.raise.text.text="Raise All-In"):(s>i&&(i=s),self.arrayOfParentsOfStageAndOfContainerArray[self.images.bet.position.z.stage].stage.contains(self.images.bet.text)?self.images.bet.text.text="Bet "+e:self.getParentOfStageObject(self.images.raise).stage.contains(self.images.raise.text)&&(self.images.raise.text.text="Raise to "+e)),self.images.betSlider.vertical.image.x=i,self.images.bet.messages=["act","bet",e],self.images.raise.messages=["act","raise",e],self.updateBetSize(e),this.updateStages(self.images.betSlider.vertical.position.z.stage)},this.displayAllCommunity=function(e,s){for(var t=[],a=0;a<e.length;a+=1)_.isString(e[a])&&e[a].length>=2&&t.push(this.displayShownCard(e[a],this.images.community[a],s));return t},this.getParentOfStageObject=function(e){if(e instanceof this.images.Item){var s=this.arrayOfParentsOfStageAndOfContainerArray[e.position.z.stage];return s}},this.updateBetSize=function(e){$("#betSize").val(e),self.gameState.betSize=e},this.displayImage=function(e,s){if(_.isObject(s))var t=_.clone(s);else var t={};if(_.isNumber(t.stageNumber)||(t.stageNumber=e.position.z.stage),t.container)var a=t.container;else var a=e.position.z.container;if(e.image)if(_.isString(e.image.innerHTML))$(e.image).css("display","inline");else if(this.arrayOfParentsOfStageAndOfContainerArray[t.stageNumber].containers[a].contains(e.image)!==!0){this.addChildToContainer(e.image,a,t),this.arrayOfParentsOfStageAndOfContainerArray[t.stageNumber].upToDate=!1;var i=t.stageNumber}if(t.update!==!1&&this.arrayOfParentsOfStageAndOfContainerArray[t.stageNumber].upToDate!==!0||t.update===!0){this.updateStages(s.stageNumber);var i=!1}return i},this.displayText=function(e,s){if(_.isObject(s))var t=_.clone(s);else var t={};if(_.isNumber(s.stageNumber)||(t.stageNumber=e.position.z.stage),s.container)var a=t.container;else var a=e.position.z.container;if(e.text)if(_.isString(e.text.innerHTML))$(e.text).css("display","inline");else if(this.arrayOfParentsOfStageAndOfContainerArray[t.stageNumber].containers[a+1].contains(e.text)!==!0){this.addChildToContainer(e.text,a+1,t),this.arrayOfParentsOfStageAndOfContainerArray[t.stageNumber].upToDate=!1;var i=t.stageNumber}if(t.update!==!1&&this.arrayOfParentsOfStageAndOfContainerArray[t.stageNumber].upToDate!==!0||t.update===!0){this.updateStages(t.stageNumber);var i=!1}return i},this.displayChildren=function(e,s){if(!s)var s={};var t=s.update;s.update=!1;var a=[];if(e instanceof this.images.Item)a.push(this.displayImage(e,s)),a.push(this.displayText(e,s));else if(_.isArray(e))for(var i=0;i<e.length;i++)e[i]instanceof this.images.Item&&(a.push(this.displayImage(e[i],s)),a.push(this.displayText(e[i],s)));else if(_.isObject(e))for(var i in e)e[i]instanceof this.images.Item&&(a.push(this.displayImage(e[i],s)),a.push(this.displayText(e[i],s)));return t===!1?a:(s.update=t,this.updateStages(a,s),void 0)},this.displayHiddenCards=function(e,s){var t=[];return t.push(this.displayChildren(this.images.seats[e].hiddenCard0,s)),t.push(this.displayChildren(this.images.seats[e].hiddenCard1,s)),t},this.hideText=function(e,s){if(_.isObject(s))var t=_.clone(s);else var t={};if(_.isNumber(t.stageNumber))var a=t.stageNumber;else var a=e.position.z.stage;if(_.isNumber(t.container))var i=t.container;else var i=e.position.z.container;if(e.text)if(_.isString(e.text.innerHTML))$(e.text).css("display","none");else if(this.arrayOfParentsOfStageAndOfContainerArray[a].containers[i+1].contains(e.text)){self.arrayOfParentsOfStageAndOfContainerArray[a].containers[i+1].removeChild(e.text),this.arrayOfParentsOfStageAndOfContainerArray[a].upToDate=!1;var n=a}if(t.update!==!1&&this.arrayOfParentsOfStageAndOfContainerArray[a].upToDate!==!0||t.update===!0){this.updateStages(a);var n=!1}return n},this.hideImage=function(e,s){if(_.isObject(s))var t=_.clone(s);else var t={};if(_.isNumber(t.stageNumber))var a=t.stageNumber;else var a=e.position.z.stage;if(_.isNumber(t.container))var i=t.container;else var i=e.position.z.container;if(e.image)if(_.isString(e.image.innerHTML))$(e.image).css("display","none");else if(self.arrayOfParentsOfStageAndOfContainerArray[a].containers[i].contains(e.image)){self.arrayOfParentsOfStageAndOfContainerArray[a].containers[i].removeChild(e.image),this.arrayOfParentsOfStageAndOfContainerArray[a].upToDate=!1;var n=a}if(t.update!==!1&&this.arrayOfParentsOfStageAndOfContainerArray[a].upToDate!==!0||t.update===!0){this.updateStages(a);var n=!1}return n},this.playerSitsOut=function(e,s){if("Sitting Out"!==this.images.seats[e].status.text.text){if(this.images.seats[e].status.text.text="Sitting Out",s&&s.update===!1)return this.images.seats[e].status.position.z.stage;this.updateStages(this.images.seats[e].status.position.z.stage)}},this.hideChildren=function(e,s){if(!s)var s={};var t=s.update;s.update=!1;var a=[];if(e instanceof this.images.Item)a.push(this.hideImage(e,s)),a.push(this.hideText(e,s));else if(_.isArray(e))for(var i=0;i<e.length;i++)e[i]instanceof this.images.Item&&(a.push(this.hideImage(e[i],s)),a.push(this.hideText(e[i],s)));else if(_.isObject(e))for(var i in e)e[i]instanceof this.images.Item&&(a.push(this.hideImage(e[i],s)),a.push(this.hideText(e[i],s)));return t===!1?a:(s.update=t,this.updateStages(a,s),void 0)},this.hideAllActionButtons=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];return t.push(this.hideChildren(this.images.fold,e)),t.push(this.hideChildren(this.images.call,e)),t.push(this.hideChildren(this.images.check,e)),t.push(this.hideChildren(this.images.raise,e)),t.push(this.hideChildren(this.images.bet,e)),t.push(this.hideChildren(this.images.betSlider,e)),t=_.flatten(t),s===!1?t:(this.updateStages(t),$("#betSize").css("display","none"),void 0)
},this.roundEnds=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];t.push(this.hideChildren(this.images.community[a]));for(var a=0;a<this.images.seats.length;a++)this.hideChildren(this.images.seats[a].hiddenCard0,{update:!1}),this.hideChildren(this.images.seats[a].hiddenCard1,{update:!1}),this.hideChildren(this.images.seats[a].shownCard0,{update:!1}),this.hideChildren(this.images.seats[a].shownCard1,{update:!1});t.push(this.images.seats[0].hiddenCard0.position.z.stage),t.push(this.images.seats[0].shownCard0.position.z.stage),t.push(self.hideAllBets(e)),t.push(self.hideChildren(self.images.totalPotSize,{update:!1}));for(var a=0;a<this.images.pots.length;a++)t.push(self.hideChildren(self.images.pots[a].potSize,{update:!1})),t.push(self.hideChildren(self.images.pots[a].chips,{update:!1}));return e.update=s,s===!1?t:(this.updateStages(t),$(this.arrayOfParentsOfStageAndOfContainerArray[this.images.betSlider.vertical.position.z.stage].stage.canvas,"#betSize").unbind("mousewheel"),$("#betSizeDiv").unbind("mousewheel"),void 0)},this.winners=function(e){for(var s=0,t=0;t<e.length;t++)e[t].chips_won.length>s&&(s=e[t].chips_won.length);for(var a=[],t=0;s>t;t++)a.push("placeholder");for(var i=1e3,n=3e3,l=8,o=[],t=0;t<e.length;t++)o.push([]);for(var r=0,h=[],g=[],m=[],d=[],f=[],t=0;t<self.images.seats.length;t++)f.push(0);for(var t=0;t<a.length;t++){h.push([]),m.push([]);for(var c=0;c<e.length;c++){var u=e[c].chips_won[t];u>0&&(g.push([]),h[t].push({seat:e[c].seat,amountWon:u,temporaryStackNumber:g.length-1}))}}_.each(_.range(h.length),function(e){var s=0;_.isEmpty(h[e])||(_.each(_.range(h[e].length),function(t){var a=self.images.seats[h[e][t].seat].firstChip.position.x-self.images.pots[e].firstChip.position.x,n=self.images.seats[h[e][t].seat].firstChip.position.y-self.images.pots[e].firstChip.position.y;self.images.seats[h[e][t].seat].secondColumnChip.position.x-self.images.seats[h[e][t].seat].firstChip.position.x,self.displayChipStack(h[e][t].amountWon,g[h[e][t].temporaryStackNumber],self.images.pots[e].firstChip.position.x,self.images.pots[e].firstChip.position.y,{hidden:!0}),m[e].push(function(a){self.displayChildren(g[h[e][t].temporaryStackNumber].chips),console.log("displaying the chips of player "+h[e][t].seat),a(null,s)}),s++,_.each(_.range(g[h[e][t].temporaryStackNumber].chips.length),function(o){m[e].push(function(r){self.animateImage(g[h[e][t].temporaryStackNumber].chips[o].position.x,g[h[e][t].temporaryStackNumber].chips[o].position.y,i,l,g[h[e][t].temporaryStackNumber].chips[o],g[h[e][t].temporaryStackNumber].chips[o].position.x+a,g[h[e][t].temporaryStackNumber].chips[o].position.y+n,function(){r(null,s)})}),s++})}),r++)});var p=0;_.each(_.range(m.length),function(e){_.isEmpty(m[e])||(d.push(function(s){self.hideChildren(self.images.pots[e].chips),self.hideChildren(self.images.pots[e].potSize),async.parallel(m[e],function(){s(null,p)})}),p++,d.push(function(s){_.each(_.range(h[e].length),function(s){var t=h[e][s].seat;f[t]=h[e][s].amountWon+f[t],console.log("drawing chips next to player"+t+" seat"),console.log("chips = "+f[t]+" at "+self.images.seats[t].firstChip.position.x+", "+self.images.seats[t].firstChip.position.y),console.log(t),self.images.seats[t].bet.text.text=f[t],self.displayChipStack(f[t],self.images.seats[t],self.images.seats[t].firstChip.position.x,self.images.seats[t].firstChip.position.y),self.displayChildren(self.images.seats[t].bet),self.arrayOfParentsOfStageAndOfContainerArray[self.images.seats[t].chips[0].position.z.stage].stage.contains(self.images.seats[t].chips[0].image)&&console.log(self.images.seats[t].chips),self.hideChildren(g[h[e][s].temporaryStackNumber].chips),console.log("finished hiding temporary stack number "+h[e][s].temporaryStackNumber)}),console.log("start waiting after pot number "+e),setTimeout(function(){console.log("callback function called"),s(null,p)},n)}),p++)}),d.push(function(s){for(var t=0;t<e.length;t++)self.images.seats[e[t].seat].status.text.text=e[t].chips,console.log("setting player number "+e[t].seat),t==e.length-1&&s(null,p)}),async.series(d,function(e,s){self.updateStages(self.images.seats[0].status.position.z.stage),console.log("winners async series completed with the following errors next line and results 2nd line"),console.log(e),console.log(s)})},this.checkIfTableChatFullMessageTextShouldBeScrolledAfterChangingText=function(){if(console.log("checking if messageText is at bottom"),self.permanentPreferences.tableChatFull.scrollBarType&&"mCustomScrollbar"==self.permanentPreferences.tableChatFull.scrollBarType.value){console.log("assinging isAtBottom is true because i dontk now how to do it on mcustomscrollbar");var e=!0}else{var s=self.jQueryObjects.tableChatFullDiv.getNiceScroll();console.log("content size = "+s[0].getContentSize().h+" upper scroll value = "+s[0].getScrollTop()+" height of visible paragraph = "+(self.jQueryObjects.tableChatFullParagraph.outerHeight(!0)+1));var e=s[0].getContentSize().h-s[0].getScrollTop()<=parseFloat(self.jQueryObjects.tableChatFullParagraph.outerHeight(!0))+1}return console.log("var isAtBottom = "+e),e},this.displayBubbleChat=function(e){if(self.images.seats[e.seat].chat.text.text="",e.message=e.message.replace(/^\s+|\s+$/g,""),/\S/.test(e.message)){createjs.Tween.removeTweens(self.images.seats[e.seat].chat.image);var s;originalImageAlpha=self.imageData.chatBoxAlpha;for(var t=1,a=!1,i=0,n=!1,l=0,o=!1,r=0,h=self.images.seats[e.seat].chat.text.font,g=/^[\.,-\/#!$%\^&\*;:{}=\-_`~()]+$/;0==a;){o=!1,s=e.message.substring(self.images.seats[e.seat].chat.text.text.length-r,e.message.length);for(var m=!0;m===!0&&self.getStringWidth(s,h)>self.images.seats[e.seat].chat.text.lineWidth;){var d=s.charAt(s.length-1);if(s=s.substring(0,s.length-1),self.getStringWidth(s,h)<=self.images.seats[e.seat].chat.text.lineWidth){var m=!1;" "===d&&(s+=d)," "===s.charAt(s.length-1)?o=!0:" "===s.charAt(s.length-2)?(s=s.substring(0,s.length-1),o=!0):g.test(d)||g.test(s.charAt(s.length-1))?(s+=" ",r+=1,o=!0):(s=s.substring(0,s.length-1),o=!0,g.test(s.charAt(s.length-1))?(s+=" ",r+=1):(s+="- ",r+=2))}}self.images.seats[e.seat].chat.text.text=self.images.seats[e.seat].chat.text.text+s,1==o?t<self.permanentPreferences.playerChatMaxLines.value?(t++,i++):(a=!0,self.images.seats[e.seat].chat.text.text.length-r==e.message.length||(n=!0)):a=!0}1==n&&(self.images.seats[e.seat].chat.text.text=self.images.seats[e.seat].chat.text.text.substring(0,self.images.seats[e.seat].chat.text.text.length-4),self.images.seats[e.seat].chat.text.text=self.images.seats[e.seat].chat.text.text+"...");var f=self.images.seats[e.seat].chat.size.x/self.images.seats[e.seat].chat.text.lineWidth;l=t>1?self.images.seats[e.seat].chat.text.lineWidth:self.getStringWidth(self.images.seats[e.seat].chat.text.text,h);var c=f*l+1;console.log("drawing chat widh Width of "+c),self.images.seats[e.seat].chat.image.drawChat(c,t),self.images.seats[e.seat].chat.text.alpha=1,self.images.seats[e.seat].chat.text.y=self.images.seats[e.seat].chat.position.y-(t-1)*self.images.seats[e.seat].chat.text.getMeasuredLineHeight(),console.log(self.images.seats[e.seat].chat),self.displayChildren(self.images.seats[e.seat].chat),console.log(self.images.seats[e.seat].chat.text.text),createjs.Tween.get(self.images.seats[e.seat].chat.image,{loop:!1,override:!0}).to({alpha:originalImageAlpha}).to({alpha:0},1e4).call(self.hideImage,[self.images.seats[e.seat].chat],self).to({alpha:originalImageAlpha}),createjs.Tween.get(self.images.seats[e.seat].chat.text,{loop:!1,override:!0}).to({alpha:1}).to({alpha:0},1e4).call(self.hideText,[self.images.seats[e.seat].chat],self).to({alpha:1})}},this.appendTableChatFullMessageText=function(e,s){var t=this.checkIfTableChatFullMessageTextShouldBeScrolledAfterChangingText();self.jQueryObjects.tableChatFullParagraph.append("<br>"+e),1==t&&1!=self.gameState.tableChatFull.mouseDown&&s&&s.moveTable!==!1?self.moveTableChatFullMessageText():s&&1==s.moveTable&&self.moveTableChatFullMessageText()},this.updateTableChatFullMessageTextFromCurrentOrAdditionalData=function(e,s){var t,a,i,n=this.gameState.tableChatFull.currentlyDisplayingDealerMessages,l=this.gameState.tableChatFull.currentlyDisplayingPlayerMessages,o=this.gameState.tableChatFull.currentlyDisplayingObserverMessages;t=self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideDealerMessagesOn.value===!1?!0:!1,a=self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hidePlayerMessagesOn.value===!1?!0:!1,i=self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideObserverMessagesOn.value===!1?!0:!1;var r=n!==t||l!==a||o!==i,h=this.checkIfTableChatFullMessageTextShouldBeScrolledAfterChangingText();if(console.log("needToUpdate = "+r),r===!0||s&&s.update===!0){self.gameState.tableChatFull.fullTextString="";for(var g,m=0;m<self.gameState.tableChatFull.log.length;m++)g="dealer"===self.gameState.tableChatFull.log[m][0]?t:"observer"===self.gameState.tableChatFull.log[m][0]?i:a,g===!0&&(self.gameState.tableChatFull.fullTextString.length>0&&(self.gameState.tableChatFull.fullTextString=self.gameState.tableChatFull.fullTextString+"<br>"),self.gameState.tableChatFull.fullTextString=self.gameState.tableChatFull.fullTextString+self.gameState.tableChatFull.log[m][1]);self.jQueryObjects.tableChatFullParagraph.html(self.gameState.tableChatFull.fullTextString),this.gameState.tableChatFull.currentlyDisplayingDealerMessages=t,this.gameState.tableChatFull.currentlyDisplayingPlayerMessages=a,this.gameState.tableChatFull.currentlyDisplayingObserverMessages=i}e&&e.chatSourceType&&e.message&&(this.gameState.tableChatFull.log.push([e.chatSourceType,e.message]),e.timeStampString&&this.gameState.tableChatFull.log[this.gameState.tableChatFull.log.length-1].push(e.timeStampString),this.appendTableChatFullMessageText(e.message,{moveTable:!1})),h===!0?this.moveTableChatFullMessageText({resize:!0}):this.moveTableChatFullMessageText({magnitude:0,resize:!0})},this.displayopenSeats=function(e){for(var s=0;s<e.length;s+=1)this.displayImage(this.images.seats[e[s]].openSeat),this.displayText(this.images.seats[e[s]].openSeat)},this.displayInHandOptions=function(){this.displayChildren(this.images.foldToAnyBet),this.displayChildren(this.images.sitOutNextHand),this.displayChildren(this.images.sitOutNextBlind)},this.hideSeatedOptions=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];return this.images.standUp.image.onClick=null,this.images.getChips.image.onClick=null,t.push(this.displayChildren(this.images.standUpDisabledShape,e)),t.push(this.displayChildren(this.images.getChipsDisabledShape,e)),t.push(this.hideChildren(self.images.sitOutNextHandOn,e)),t.push(this.hideChildren(self.images.sitOutNextHand,e)),t.push(this.hideChildren(self.images.sitOutNextBlind,e)),t.push(this.hideChildren(self.images.sitOutNextBlindOn,e)),t.push(this.hideChildren(self.images.foldToAnyBet,e)),t.push(this.hideChildren(self.images.foldToAnyBetOn,e)),t.push(self.hideChildren(self.images.rebuy,e)),t.push(self.hideChildren(self.images.sitIn,e)),t.push(this.hideAllActionButtons(e)),s===!1?t:(this.updateStages(t),void 0)},this.displayBetSlider=function(e,s,t){this.gameState.minBet=e,this.gameState.maxBet=s,this.gameState.minIncrement=t,this.images.betSlider.vertical.image.x=this.images.betSlider.vertical.position.x,this.updateBetSize(e),this.displayChildren(this.images.betSlider),$(this.getParentOfStageObject(this.images.betSlider.vertical).stage.canvas).bind("mousewheel",function(e,s,t,a){self.events.wheelScroll(a)}),$("#betSizeDiv").bind("mousewheel",function(e,s,t,a){self.events.wheelScroll(a)})},this.playerChats=function(e){this.gameState.tableChatFull.log.push(e)},this.displayCorrectSeatMessage=function(e,s){if(!s)var s={};var t=s.update;s.update=!1;var a=[];switch(this.gameState.seats[e].displayMessageType){case"seat":a.push(this.displayChildren(this.images.seats[e].seat,s)),a.push(this.displayChildren(this.images.seats[e].status,s)),a.push(this.displayChildren(this.images.seats[e].playerName,s)),a.push(this.hideText(this.images.seats[e].action,s)),a.push(this.hideText(this.images.seats[e].winner,s)),a.push(this.hideText(this.images.seats[e].countdown,s)),a.push(this.hideChildren(this.images.seats[e].openSeat,s)),a.push(this.hideChildren(this.images.seats[e].disabledSeat,s));break;case"countdown":a.push(this.displayChildren(this.images.seats[e].seat,s)),self.gameState.seats[e].toAct===!0?(a.push(this.displayText(this.images.seats[e].countdown,s)),a.push(this.hideChildren(this.images.seats[e].playerName,s))):(a.push(this.displayChildren(this.images.seats[e].playerName,s)),a.push(this.hideText(this.images.seats[e].countdown,s))),a.push(this.displayChildren(this.images.seats[e].status,s)),a.push(this.hideText(this.images.seats[e].action,s)),a.push(this.hideText(this.images.seats[e].winner,s)),a.push(this.hideChildren(this.images.seats[e].openSeat,s)),a.push(this.hideChildren(this.images.seats[e].disabledSeat,s));break;case"action":a.push(this.displayChildren(this.images.seats[e].seat,s)),a.push(this.displayText(this.images.seats[e].action,s)),a.push(this.displayChildren(this.images.seats[e].status,s)),a.push(this.hideChildren(this.images.seats[e].playerName,s)),a.push(this.hideText(this.images.seats[e].winner,s)),a.push(this.hideText(this.images.seats[e].seat,s)),a.push(this.hideText(this.images.seats[e].countdown,s)),a.push(this.hideChildren(this.images.seats[e].openSeat,s)),a.push(this.hideChildren(this.images.seats[e].disabledSeat,s));break;case"winner":a.push(this.displayChildren(this.images.seats[e].seat,s)),a.push(this.displayChildren(this.images.seats[e].status,s)),a.push(this.displayChildren(this.images.seats[e].winner,s)),a.push(this.hideChildren(this.images.seats[e].playerName,s)),a.push(this.hideText(this.images.seats[e].action,s)),a.push(this.hideText(this.images.seats[e].countdown,s)),a.push(this.hideChildren(this.images.seats[e].openSeat,s)),a.push(this.hideChildren(this.images.seats[e].disabledSeat,s));break;case"openSeat":_.isNumber(this.gameState.userSeatNumber)?(a.push(this.hideChildren(this.images.seats[e].openSeat,s)),a.push(this.displayChildren(this.images.seats[e].disabledSeat,s))):(0==this.gameState.userSeatNumber||_.isNull(this.gameState.userSeatNumber)||_.isUndefined(this.gameState.userSeatNumber))&&(a.push(this.hideChildren(this.images.seats[e].disabledSeat,s)),a.push(this.displayChildren(this.images.seats[e].openSeat,s))),a.push(this.hideChildren(this.images.seats[e].seat,s)),a.push(this.hideChildren(this.images.seats[e].status,s)),a.push(this.hideChildren(this.images.seats[e].playerName,s)),a.push(this.hideText(this.images.seats[e].action,s)),a.push(this.hideText(this.images.seats[e].winner,s)),a.push(this.hideText(this.images.seats[e].countdown,s));break;default:_.isNumber(this.gameState.userSeatNumber)?(a.push(this.hideChildren(this.images.seats[e].openSeat,s)),a.push(this.displayChildren(this.images.seats[e].disabledSeat,s))):(a.push(this.hideChildren(this.images.seats[e].disabledSeat,s)),a.push(this.displayChildren(this.images.seats[e].openSeat,s))),a.push(this.hideChildren(this.images.seats[e].seat,s)),a.push(this.hideChildren(this.images.seats[e].status,s)),a.push(this.hideChildren(this.images.seats[e].playerName,s)),a.push(this.hideText(this.images.seats[e].action,s)),a.push(this.hideText(this.images.seats[e].winner,s)),a.push(this.hideText(this.images.seats[e].countdown,s))}return t===!1?a:(this.updateStages(a),void 0)},this.playerActs=function(e,s,t){e===self.gameState.userSeatNumber&&this.hideAllActionButtons(this.gameState.userSeatNumber),this.gameState.seats[e].displayMessageType="action",self.images.seats[e].action.text.text=s;var a,i=100;a=t&&"number"==typeof t?t:2;var n=setInterval(function(){"action"!=self.gameState.seats[e].displayMessageType||0>=a?("action"===self.gameState.seats[e].displayMessageType&&(self.gameState.seats[e].displayMessageType="seat"),clearInterval(n)):a>1?(self.images.seats[e].action.text.alpha=1,self.images.seats[e].action.text.text=s,self.updateStages(self.images.seats[e].action.position.z.stage)):(self.images.seats[e].action.text.alpha=a,self.images.seats[e].action.text.text=s,self.updateStages(self.images.seats[e].action.position.z.stage)),a-=i/1e3,self.displayCorrectSeatMessage(e)},i)},this.playerWins=function(e,s,t){"winner"===this.gameState.seats[e].displayMessageType,self.images.seats[e].winner.text.text="";var a,i=100;a=_.isNumber(t)?t:2.5;var n=setInterval(function(){var t=[];"winner"!=self.gameState.seats[e].displayMessageType||0>=a?("winner"===self.gameState.seats[e].displayMessageType&&(self.gameState.seats[e].displayMessageType="seat"),clearInterval(n)):a>1?(self.images.seats[e].winner.text.alpha=1,self.images.seats[e].winner.text.text="Wins "+s,t.push(self.images.seats[e].winner.position.z.stage)):(self.images.seats[e].winner.text.alpha=a,self.images.seats[e].winner.text.text="Wins "+s,t.push(self.images.seats[e].winner.position.z.stage)),a-=i/1e3,t.push(self.displayCorrectSeatMessage(e,{update:!1})),self.updateStages(t)},i)},this.playerToAct=function(e,s){self.gameState.seats[e].timeToActInMS=s,self.gameState.seats[e].toAct=!0,self.gameState.seats[e].displayMessageType="countdown";var t=function(e){var s=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(s,function(e,s,t,a){return s+s+t+t+a+a});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},a=function(e){if("r"==e.charAt(0)){var s=[];s=e.replace(/[^\d,]/g,"").split(","),red=parseInt(s[0]),green=parseInt(s[1]),blue=parseInt(s[2])}else if("#"==e.charAt(0)){var a=t(e);red=parseInt(a.r),green=parseInt(a.g),blue=parseInt(a.b)}return[red,green,blue]},i=function(e){return colorString="rgb("+e[0]+","+e[1]+","+e[2]+")"},n=self.images.seats[0].seat.image.borderColor,l=self.images.seats[0].seat.image.middleDividerColor,o="#FFFF00",r=n,h="#FFFFFF",g=3e3,m=15,d=g/m,f=self.images.seats[e].seat.image.fillColor,c=[[255,0,0],[0,0,0]],u=-1,p=setInterval(function(){var t,g,x,b,C,S,y,v,O,I,B,z,w,A,F,T=[],P=self.images.seats[e].seat.image.fillColor,k=a(P);if(t=k[0],g=k[1],x=k[2],-1==u){var D=a(f);b=D[0],C=D[1],S=D[2]}else{var _=u%c.length,N=i(c[_]),D=a(N);b=D[0],C=D[1],S=D[2]}var M=(u+1)%c.length,j=i(c[M]),H=a(j);y=H[0],v=H[1],O=H[2],I=(y-b)/m,B=(v-C)/m,z=(O-S)/m,w=parseInt(t+I),A=parseInt(g+B),F=parseInt(x+z);var W=u+1;if(0>I&&y>=w&&(u=W),I>0&&w>=y&&(u=W),0>B&&v>=A&&(u=W),B>0&&A>=v&&(u=W),0>z&&O>=F&&(u=W),z>0&&F>=O&&(u=W),w>255&&(w=255),A>255&&(A=255),F>255&&(F=255),0>w&&(w=0),0>A&&(A=0),0>F&&(F=0),newFillColor=i([w,A,F]),self.gameState.seats[e].toAct===!1)clearInterval(p),T.push(self.images.drawSeat(self.images.seats[e].seat,n,f,l)),"countdown"==self.gameState.seats[e].displayMessageType&&(self.gameState.seats[e].displayMessageType="seat");else{T.push(self.images.drawSeat(self.images.seats[e].seat,r,newFillColor,h,{borderFillRatio:self.gameState.seats[e].timeToActInMS/s,newFillColor:o}));var $="Time: "+Math.ceil(self.gameState.seats[e].timeToActInMS/1e3);if(self.gameState.seats[e].timeToActInMS>=0&&self.images.seats[e].countdown.text.text!==$){self.images.seats[e].countdown.text.text=$;var E=self.images.seats[e].countdown.position.z.stage,R=self.images.seats[e].countdown.position.z.container;self.arrayOfParentsOfStageAndOfContainerArray[E].containers[R].contains(self.images.seats[e].countdown.text)&&(self.arrayOfParentsOfStageAndOfContainerArray[E].upToDate=!1,T.push(E))}}T.push(self.displayCorrectSeatMessage(e,{update:!1})),self.updateStages(T),self.gameState.seats[e].timeToActInMS=self.gameState.seats[e].timeToActInMS-d},d)},this.updateTableChatFullDisplay=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];return _.each(self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem,function(s,a){self.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem[a].value===!1?(t.push(self.hideChildren(self.images.tableChatFull[a],e)),console.log("hiding"+a)):t.push(self.displayChildren(self.images.tableChatFull[a],e))}),this.updateTableChatFullMessageTextFromCurrentOrAdditionalData(),s===!1?t:(this.updateStages(t),void 0)},this.displayTableChatFull=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];this.gameState.tableChatFull.currentlyDisplayingDealerMessages=this.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideDealerMessages.value===!1?!1:!0,this.gameState.tableChatFull.currentlyDisplayingPlayerMessages=this.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hidePlayerMessages.value===!1?!1:!0,this.sessionPreferences.tableChatFull.defaultItemsToHideFalseHidesItem.hideObserverMessages.value===!1?this.gameState.tableChatFull.scurrentlyDisplayingObserverMessages=!1:this.gameState.tableChatFull.currentlyDisplayingObserverMessages=!0,t.push(this.displayChildren(this.images.hideTableChatFull,e)),t.push(this.hideChildren(this.images.showTableChatFull,e)),t.push(this.displayChildren(this.images.tableChatFull,e)),t.push(this.updateTableChatFullDisplay(e));var a=self.arrayOfParentsOfStageAndOfContainerArray[this.images.tableChatFull.htmlStageElement.position.z.stage].stage.canvas;return $(a).css("display","inline"),self.jQueryObjects.tableChatFullParagraph.css("display","inline "),s===!1?t:(this.updateStages(t),void 0)},this.hideTableChatFull=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];console.log("calling hideTableChatFull"),t.push(this.displayChildren(this.images.showTableChatFull,e)),t.push(this.hideChildren(this.images.hideTableChatFull,e)),t.push(this.hideChildren(this.images.tableChatFull,e));var a=self.arrayOfParentsOfStageAndOfContainerArray[this.images.tableChatFull.htmlStageElement.position.z.stage].stage.canvas;$(a).css("display","none"),self.jQueryObjects.tableChatFullParagraph.css("display","none"),s!==!1&&this.updateStages(t)},this.displayButton=function(e,s,t){s&&e.text&&e.text.text&&(e.text.text=s),t&&(e.messages=t),e.button&&e.bitmapAnimation&&e.button instanceof createjs.ButtonHelper?(this.addChildToContainer(e.bitmapAnimation,e.position.z),e.bitmapAnimation.gotoAndStop(0)):e.image&&(null==e.image.onClick&&(e.image.onClick=self.events.onButtonClick),null==e.image.onPress&&(e.image.onPress=self.events.buttonMouseDown),this.displayChildren(e))},this.hideCashier=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];return $(self.arrayOfParentsOfStageAndOfContainerArray[self.images.cashier.window.position.z.stage].stage.canvas).css("display","none"),self.gameState.tableChatBox.display=!1,self.enableTableChatBox(),self.jQueryObjects.cashierForm.css("display","none"),self.restoreActiveStages(self.gameState.cashier.activeStages),self.gameState.cashier.display=!1,$("#maxRadio").prop("checked",!1),$("#autoRebuyRadio").prop("checked",!1),$("#otherAmountRadio").prop("checked",!1),$("#otherAmount").val(""),$("#autoRebuyAmount").val(""),$("#maxAmount").val(""),t.push(self.hideChildren(self.images.cashier,e)),s===!1?t:(self.updateStages(t),void 0)},this.hideMessageBox=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[],a=self.images.messageBox[self.gameState.messageBox.messageBoxImageContainerIndex].window.position.z.stage;return console.log(self.gameState.messageBox.messageBoxImageContainerIndex),self.gameState.messageBox.messageBoxImageContainerIndex===self.gameState.zPositionData.initialMessageBox.container&&(self.gameState.cashier.display===!0?this.jQueryObjects.cashierForm.css("display","inline"):1==self.gameState.tableChatBox.display&&self.enableTableChatBox()),t.push(self.hideChildren(self.images.messageBox[self.gameState.messageBox.messageBoxImageContainerIndex],e)),self.gameState.messageBox.messageBoxImageContainerIndex===self.gameState.zPositionData.initialMessageBox.container&&(self.restoreActiveStages(self.gameState.messageBox.activeStages[self.gameState.messageBox.messageBoxImageContainerIndex]),$(self.arrayOfParentsOfStageAndOfContainerArray[a].stage.canvas).css("display","none")),self.gameState.messageBox.messageBoxImageContainerIndex=self.gameState.messageBox.messageBoxImageContainerIndex-self.gameState.zPositionData.containersPerMessageBox,s===!1?t:(this.updateStages(t),void 0)},this.displayMessageBox=function(messageString,messageInfo,hideOrDisplayChildrenOptions){if(!hideOrDisplayChildrenOptions)var hideOrDisplayChildrenOptions={};var update=hideOrDisplayChildrenOptions.update;hideOrDisplayChildrenOptions.update=!1;for(var stagesToUpdate=[],messageBoxStageNumber=this.images.messageBox[0].window.position.z.stage,messageBoxImageContainerIndex=this.images.messageBox[0].window.position.z.container,initialContainer=messageBoxImageContainerIndex,incrementOfContainersPerMessageBox=this.gameState.zPositionData.containersPerMessageBox,i=initialContainer;i<this.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].containers.length-incrementOfContainersPerMessageBox;i++)this.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].containers[i]&&0==this.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].containers[i].isVisible()&&(messageBoxImageContainerIndex=i,i=this.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].containers.length);console.log(messageBoxImageContainerIndex),self.gameState.messageBox.messageBoxImageContainerIndex=messageBoxImageContainerIndex,self.gameState.messageBox.activeStages[messageBoxImageContainerIndex]=self.storeActiveStages();var messageBoxWindowWidth=516,messageBoxWindowHeight=199,closeXWidth=31,closeXHeight=20,closeXTopOffset=1,closeXRightOffset=7,outerTopHeight=31,outerBottomHeight=8,outerSideWidth=8,htmlCanvas=this.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].stage.canvas,stageWidth=htmlCanvas.width,stageHeight=htmlCanvas.height,messageBoxWindowX=Math.floor(stageWidth/2-messageBoxWindowWidth/2),messageBoxWindowY=Math.floor(stageHeight/2-messageBoxWindowHeight/2),innerMessageBoxX=messageBoxWindowX+outerSideWidth,innerMessageBoxY=messageBoxWindowY+outerTopHeight,innerMessageBoxWidth=messageBoxWindowWidth-2*outerSideWidth,innerMessageBoxHeight=messageBoxWindowHeight-outerBottomHeight-outerTopHeight,textHeight=30,textLeftOffset=7,textTopOffset=10,textX=innerMessageBoxX+textLeftOffset,defaultMinimumButtonWidth=50,buttonHeight=22,defaultRatioOfTextWidthToButtonWidth=.9,defaultDistanceBetweenButtons=30,buttonButtomOffset=15,buttonY=messageBoxWindowY+messageBoxWindowHeight-outerBottomHeight-buttonButtomOffset-buttonHeight,backgroundContainer=0,textContainer=1,buttonContainer=2;if((_.isNull(messageInfo)||_.isUndefined(messageInfo))&&(messageInfo={}),(_.isNull(messageInfo.title)||_.isUndefined(messageInfo.title)||!_.isString(messageInfo.title)&&_.isNumber(messageInfo.title))&&(messageInfo.title=""),(_.isNull(messageInfo.titleSizeAndFont)||_.isUndefined(messageInfo.titleSizeAndFont))&&(messageInfo.titleSizeAndFont="18px Arial"),(_.isNull(messageInfo.titleColor)||_.isUndefined(messageInfo.titleColor))&&(messageInfo.titleColor="#000000"),(_.isNull(messageInfo.sizeAndFont)||_.isUndefined(messageInfo.sizeAndFont))&&(messageInfo.messageSizeAndFont="13px Arial"),(_.isNull(messageInfo.messageColor)||_.isUndefined(messageInfo.messageColor))&&(messageInfo.messageColor="#000000"),(_.isNull(messageInfo.buttonSizeAndFont)||_.isUndefined(messageInfo.buttonSizeAndFont))&&(messageInfo.buttonSizeAndFont="13px Arial"),(_.isNull(messageInfo.buttonTextColor)||_.isUndefined(messageInfo.buttonTextColor))&&(messageInfo.buttonTextColor="#FFFFFF"),(_.isNull(messageInfo.buttonBackgroundColor)||_.isUndefined(messageInfo.buttonBackgroundColor))&&(messageInfo.buttonBackgroundColor="#0000FF"),(_.isNull(messageInfo.okayText)||_.isUndefined(messageInfo.okayText))&&(messageInfo.okayText="OK"),(_.isNull(messageInfo.cancelText)||_.isUndefined(messageInfo.cancelText))&&(messageInfo.cancelText="Cancel"),_.isNumber(messageInfo.ratioOfTextWidthToButtonWidth)||(messageInfo.ratioOfTextWidthToButtonWidth=defaultRatioOfTextWidthToButtonWidth),_.isNumber(messageInfo.minimumButtonWidth)||(messageInfo.minimumButtonWidth=defaultMinimumButtonWidth),(_.isNull(messageInfo.sameSizeButtons)||_.isUndefined(messageInfo.sameSizeButtons))&&(messageInfo.sameSizeButtons=!0),_.isNumber(messageInfo.okayWidth)||(console.log("calculating width of okay /cancel buttons"),console.log(messageInfo.okayText),messageInfo.okayWidth=this.getStringWidth(messageInfo.okayText,messageInfo.buttonSizeAndFont)/messageInfo.ratioOfTextWidthToButtonWidth),messageInfo.okayWidth<messageInfo.minimumButtonWidth&&(messageInfo.okayWidth=messageInfo.minimumButtonWidth),_.isNumber(messageInfo.cancelWidth)||(messageInfo.cancelWidth=this.getStringWidth(messageInfo.cancelText,messageInfo.buttonSizeAndFont)/messageInfo.ratioOfTextWidthToButtonWidth),messageInfo.cancelWidth<messageInfo.minimumButtonWidth&&(messageInfo.cancelWidth=messageInfo.minimumButtonWidth),messageInfo.sameSizeButtons===!0&&(messageInfo.cancelWidth<messageInfo.okayWidth?messageInfo.cancelWidth=messageInfo.okayWidth:messageInfo.okayWidth=messageInfo.cancelWidth),_.isNumber(messageInfo.distanceBetweenButtons)||(messageInfo.distanceBetweenButtons=defaultDistanceBetweenButtons),messageInfo.cancel!==!0)var okayX=stageWidth/2-messageInfo.okayWidth/2;else var okayX=stageWidth/2-messageInfo.distanceBetweenButtons/2-messageInfo.okayWidth,cancelX=stageWidth/2+messageInfo.distanceBetweenButtons/2;self.images.messageBox[messageBoxImageContainerIndex].window.position.x=messageBoxWindowX,self.images.messageBox[messageBoxImageContainerIndex].window.position.y=messageBoxWindowY,self.images.messageBox[messageBoxImageContainerIndex].window.size.x=messageBoxWindowWidth,self.images.messageBox[messageBoxImageContainerIndex].window.size.y=messageBoxWindowHeight,self.positionItemImage(self.images.messageBox[messageBoxImageContainerIndex].window,{update:!1});var closeX=messageBoxWindowX+messageBoxWindowWidth-closeXRightOffset-closeXWidth,closeY=messageBoxWindowY+closeXTopOffset;self.images.messageBox[messageBoxImageContainerIndex].closeWindow.position.x=closeX,self.images.messageBox[messageBoxImageContainerIndex].closeWindow.position.y=closeY,self.images.messageBox[messageBoxImageContainerIndex].closeWindow.size.x=closeXWidth,self.images.messageBox[messageBoxImageContainerIndex].closeWindow.size.y=closeXHeight,self.positionItemImage(self.images.messageBox[messageBoxImageContainerIndex].closeWindow,{update:!1}),messageInfo.closeWindowMessages&&(self.images.messageBox[messageBoxImageContainerIndex].closeWindow.messages=messageInfo.closeWindowMessages),self.images.messageBox[messageBoxImageContainerIndex].closeWindow.image.onClick=messageInfo.closeWindowEvent?_.isString(messageInfo.closeWindowEvent)?eval(messageInfo.closeWindowEvent):messageInfo.closeWindowEvent:function(e){self.events.onButtonClick(e),self.hideMessageBox()},self.images.messageBox[messageBoxImageContainerIndex].windowTitle=new self.images.Item(messageBoxWindowX,messageBoxWindowY,messageBoxWindowWidth,outerTopHeight,{stage:messageBoxStageNumber,container:messageBoxImageContainerIndex+textContainer}),self.images.addItemText(self.images.messageBox[messageBoxImageContainerIndex].windowTitle,messageInfo.title,messageInfo.titleSizeAndFont,messageInfo.titleColor),self.images.messageBox[messageBoxImageContainerIndex].message=new self.images.Item(textX,innerMessageBoxY+textTopOffset,innerMessageBoxWidth-2*textLeftOffset,textHeight,{stage:messageBoxStageNumber,container:messageBoxImageContainerIndex+textContainer}),self.images.addItemText(self.images.messageBox[messageBoxImageContainerIndex].message,messageString,messageInfo.messageSizeAndFont,messageInfo.messageColor),self.images.messageBox[messageBoxImageContainerIndex].message.text.lineWidth=.9*self.images.messageBox[messageBoxImageContainerIndex].message.size.x,self.images.messageBox[messageBoxImageContainerIndex].message.text.maxWidth=null,self.images.messageBox[messageBoxImageContainerIndex].okay=new self.images.Item(okayX,buttonY,messageInfo.okayWidth,buttonHeight,{stage:messageBoxStageNumber,container:messageBoxImageContainerIndex+buttonContainer}),self.images.itemAsRectangle(self.images.messageBox[messageBoxImageContainerIndex].okay,messageInfo.buttonBackgroundColor),self.images.addItemText(self.images.messageBox[messageBoxImageContainerIndex].okay,messageInfo.okayText,messageInfo.buttonSizeAndFont,messageInfo.buttonTextColor),messageInfo.okayMessages&&(self.images.messageBox[messageBoxImageContainerIndex].okay.messages=messageInfo.okayMessages),self.images.messageBox[messageBoxImageContainerIndex].okay.image.onClick=messageInfo.okayEvent?_.isString(messageInfo.okayEvent)?eval(messageInfo.okayEvent):messageInfo.okayEvent:function(e){self.events.onButtonClick(e),self.hideMessageBox()
},messageInfo.cancel&&1==messageInfo.cancel?(self.images.messageBox[messageBoxImageContainerIndex].cancel=new self.images.Item(cancelX,buttonY,messageInfo.cancelWidth,buttonHeight,{stage:messageBoxStageNumber,container:messageBoxImageContainerIndex+buttonContainer}),self.images.itemAsRectangle(self.images.messageBox[messageBoxImageContainerIndex].cancel,messageInfo.buttonBackgroundColor),self.images.addItemText(self.images.messageBox[messageBoxImageContainerIndex].cancel,messageInfo.cancelText,messageInfo.buttonSizeAndFont,messageInfo.buttonTextColor),messageInfo.cancelMessages&&(self.images.messageBox[messageBoxImageContainerIndex].cancel.messages=messageInfo.cancelMessages),self.images.messageBox[messageBoxImageContainerIndex].cancel.image.onClick=messageInfo.cancelEvent?_.isString(messageInfo.cancelEvent)?eval(messageInfo.cancelEvent):messageInfo.cancelEvent:function(e){self.events.onButtonClick(e),self.hideMessageBox()}):self.images.messageBox[messageBoxImageContainerIndex].cancel=null;for(var i=0;messageBoxImageContainerIndex>i;i++)self.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].containers[i].mouseEnabled=!1;return stagesToUpdate.push(self.displayChildren(self.images.messageBox[messageBoxImageContainerIndex],hideOrDisplayChildrenOptions)),$(this.arrayOfParentsOfStageAndOfContainerArray[messageBoxStageNumber].stage.canvas).css("display","inline"),update===!1?stagesToUpdate:(this.updateStages(stagesToUpdate),void 0)},this.displayCashier=function(e,s){if(!s)var s={};var t=s.update;s.update=!1;var a=[];this.images.cashier.window.position.z.container,1==$("#tableChatBox").attr("readonly")||(this.gameState.tableChatBox.display=!0,this.disableTableChatBox()),(_.isUndefined(e.currency_per_chip)||_.isNull(e.currency_per_chip))&&(e.currency_per_chip=1),(_.isUndefined(e.currency)||_.isNull(e.currency))&&(e.currency="Chips"),this.gameState.cashier.currency=e.currency,this.gameState.cashier.min=e.min*e.currency_per_chip,this.gameState.cashier.max=e.max*e.currency_per_chip,this.gameState.cashier.balance=e.balance_in_currency,this.gameState.cashier.table_name=e.table_name,this.gameState.cashier.small_blind=e.small_blind*e.currency_per_chip,this.gameState.cashier.big_blind=e.big_blind*e.currency_per_chip,this.gameState.cashier.table_min=e.table_min*e.currency_per_chip,this.images.cashier.blinds.text.text=e.currency_per_chip*e.small_blind+"/"+e.currency_per_chip*e.big_blind,this.images.cashier.tableNameValue.text.text=e.table_name,this.images.cashier.tableMinValue.text.text=e.currency_per_chip*e.table_min,this.images.cashier.tableMaxValue.text.text=e.currency_per_chip*e.table_max,this.images.cashier.playerMinValue.text.text=e.currency_per_chip*e.min,this.images.cashier.accountBalanceValue.text.text=this.gameState.cashier.balance,this.images.cashier.currency.text.text=e.currency+":",$("#otherAmount").val(""),$("#autoRebuyAmount").val(""),$("#maxAmount").val(this.gameState.cashier.max),$("#maxAmount").attr("readonly",!0),$("#otherAmountDiv").children().mousedown(function(e){self.events.cashierInputSelected(e)}),$("#autoRebuyDiv").children().mousedown(function(e){self.events.cashierInputSelected(e)}),$("#maxDiv").children().mousedown(function(e){self.events.cashierInputSelected(e)}),$("#cashierDiv").find("input[type = 'text']").focus(function(e){self.events.onCashierTextFieldFocus(e)});var i=document.getElementById("cashier");i.style.display="inline",this.images.cashier.addChips.text.text="add chips",this.images.cashier.cancel.text.text="cancel",self.gameState.cashier.activeStages=this.storeActiveStages();for(var n=this.images.cashier.window.position.z.stage,l=0;n>l;l++)this.arrayOfParentsOfStageAndOfContainerArray[l].mouseEnabled=!1;return console.log(this.images.cashier),a.push(this.displayChildren(this.images.cashier,s)),$(this.arrayOfParentsOfStageAndOfContainerArray[this.images.cashier.window.position.z.stage].stage.canvas).css("display","inline"),t===!1?a:(this.updateStages(a),void 0)},this.storeActiveStages=function(){for(var e=[],s=0;s<this.arrayOfParentsOfStageAndOfContainerArray.length;s++)1==this.arrayOfParentsOfStageAndOfContainerArray[s].stage.mouseEnabled&&e.push(s);return e},this.restoreActiveStages=function(e){for(var s=0;s<this.arrayOfParentsOfStageAndOfContainerArray.length;s++)this.arrayOfParentsOfStageAndOfContainerArray[s].stage.mouseEnabled=!1;for(var s=0;s<e.length;s++)this.arrayOfParentsOfStageAndOfContainerArray[e[s]].stage.mouseEnabled=!0},this.streetEnds=function(e){$(this.arrayOfParentsOfStageAndOfContainerArray[this.images.betSlider.vertical.position.z.stage].stage.canvas).unbind("mousewheel"),$("#betSizeDiv").unbind("mousewheel");var s=200,t=6,a=[],i=0,n=createjs.Sound.createInstance(this.images.sources.moveChipsSound);_.each(_.range(self.images.seats.length),function(e){if(self.images.seats[e].chips.length>0&&console.log("playernumber:"+e+"size:"+self.images.seats[e].chips.length),self.images.pots[e]&&self.images.pots[e].chips&&self.images.pots[e].chips.length>0&&console.log("potnumber:"+e+"size:"+self.images.pots[e].chips.length),self.images.seats[e].chips&&_.isArray(self.images.seats[e].chips)&&self.images.seats[e].chips.length>=1&&self.images.seats[e].chips[0].image&&self.arrayOfParentsOfStageAndOfContainerArray[self.images.seats[e].chips[0].position.z.stage].stage.contains(self.images.seats[e].chips[0].image)){console.log("preparing animation");var n=self.images.pots[0].firstChip.position.x-self.images.seats[e].firstChip.position.x,l=self.images.pots[0].firstChip.position.y-self.images.seats[e].firstChip.position.y;_.each(_.range(self.images.seats[e].chips.length),function(o){a.push(function(a){self.hideText(self.images.seats[e].bet),self.animateImage(self.images.seats[e].chips[o].position.x,self.images.seats[e].chips[o].position.y,s,t,self.images.seats[e].chips[o],self.images.seats[e].chips[o].position.x+n,self.images.seats[e].chips[o].position.y+l,function(){console.log("completed animation of player"+e+" chipstack and chip number "+o),a(null,i)})}),i++})}}),async.series([function(e){a.length>0&&n.play(),async.parallel(a,function(s,t){console.log(t),(t.length=i)?(console.log("parallel all chips from players moving into pot completed"),e(null,1)):(console.log("error of chipintopot parellel animation is equal to"),console.log(s))})},function(s){self.hideAllBets({update:!1}),self.updatePotSize(e),e.length>1&&n.play(),s(null,2)}])},this.updateUserOptionsBasedOnFlagsAndPreactions=function(e){if(!e)var e={};var s=e.update;e.update=!1;var t=[];if(!_.isNumber(self.gameState.userSeatNumber))return t.push(this.hideSeatedOptions()),"display updated based on non seated player";this.images.getChips.image.onClick=self.events.onButtonClick,this.images.standUp.image.onClick=self.events.onButtonClick,t.push(this.hideChildren(this.images.getChipsDisabledShape,e)),t.push(this.hideChildren(this.images.standUpDisabledShape,e));var a=self.gameState.seats[self.gameState.userSeatNumber],i=self.gameState.seats[self.gameState.userSeatNumber].flags;self.gameState.seats[self.gameState.userSeatNumber].preActions.street;var n=self.gameState.seats[self.gameState.userSeatNumber].preActions.hand;return self.gameState.seats[self.gameState.userSeatNumber].preActions.once,1==i.pending_sit_out?(t.push(self.hideChildren(self.images.sitOutNextBlind,e)),t.push(self.hideChildren(self.images.sitOutNextBlindOn,e)),t.push(self.hideChildren(self.images.sitOutNextHand,e)),t.push(self.displayChildren(self.images.sitOutNextHandOn,e))):1!=self.gameState.seats[self.gameState.userSeatNumber].sitting_out&&(t.push(self.hideChildren(self.images.sitOutNextHandOn,e)),t.push(self.displayChildren(self.images.sitOutNextHand,e))),1==a.sitting_out?(t.push(self.hideChildren(self.images.sitOutNextBlind,e)),t.push(self.hideChildren(self.images.sitOutNextBlindOn,e)),t.push(self.hideChildren(self.images.foldToAnyBet,e)),t.push(self.hideChildren(self.images.foldToAnyBetOn,e)),t.push(this.playerSitsOut(self.gameState.userSeatNumber,e)),t.push(self.hideChildren(self.images.sitOutNextHand,e)),t.push(self.displayChildren(self.images.sitOutNextHandOn,e)),1==a.notEnoughChips?(t.push(self.hideChildren(self.images.sitIn,e)),t.push(self.displayChildren(self.images.rebuy,e))):(t.push(self.hideChildren(self.images.rebuy,e)),t.push(self.displayChildren(self.images.sitIn,e)))):(t.push(self.hideChildren(self.images.sitIn,e)),t.push(self.hideChildren(self.images.rebuy,e)),0==i.post_blind?(t.push(self.hideChildren(self.images.sitOutNextBlind,e)),t.push(self.displayChildren(self.images.sitOutNextBlindOn,e))):(t.push(self.hideChildren(self.images.sitOutNextBlindOn,e)),t.push(self.displayChildren(self.images.sitOutNextBlind,e))),this.arrayOfParentsOfStageAndOfContainerArray[self.images.seats[self.gameState.userSeatNumber].shownCard0.position.z.stage].stage.contains(self.images.seats[self.gameState.userSeatNumber].shownCard0.image)&&(1==n.check&&1==n.fold?(t.push(self.hideChildren(self.images.foldToAnyBet,e)),t.push(self.displayChildren(self.images.foldToAnyBetOn,e))):(t.push(self.hideChildren(self.images.foldToAnyBetOn,e)),t.push(self.displayChildren(self.images.foldToAnyBet,e))))),s===!1?t:(this.updateStages(t),void 0)},this.getPermanentPreferences=function(){$.getJSON("/preferences/1",function(e){console.log(e),_.isObject(e)&&self.updatePreference(self.permanentPreferences,e.permanentPreferences)})},this.saveSessionPreferences=function(){socket.emit("set_flag","sessionPreferences",this.sessionPreferences)},this.savePermanentPreferences=function(){socket.emit("set_preference","permanentpreferences",this.permanentPreferences)},this.initializeServerPreferenceObjects=function(e,s,t){return console.log("initializeserver peference called"),null},this.updatePreference=function(e,s,t){if(!t)var t={};_.isNumber(t.maxDepth)||(t.maxDepth=4),t.maxDepth--,t.maxDepth>=0&&_.each(s,function(a,i){if(!_.isUndefined(s[i])){if(_.isObject(e[i])||(e[i]={}),_.isObject(s[i])&&!_.isUndefined(s[i].value))var n=s[i].value;else if(!_.isObject(s[i]))var n=s[i];_.isUndefined(n)||n===e[i].value?self.updatePreference(e[i],s[i],t):_.isFunction(e[i].updateValue)?e[i].updateValue(n):_.isUndefined(s[i].value)||(e[i].value=n)}})},this.updateLocalGameDataBasedOnServerPlayerObject=function(e){if(1==e.is_you&&(self.gameState.userSeatNumber=e.seat),_.isObject(e.flags)){var s=e.flags;self.gameState.seats[e.seat].flags.pending_sit_out=s.pending_sit_out,self.gameState.seats[e.seat].flags.post_blind=s.post_blind,self.gameState.seats[e.seat].preActions.hand.check=s.check,self.gameState.seats[e.seat].preActions.hand.fold=s.fold}self.gameState.seats[e.seat].sitting_out=e.sitting_out,self.gameState.seats[e.seat].chips=e.chips,self.gameState.seats[e.seat].username=e.username,self.gameState.seats[e.seat].notEnoughChips=_.isNumber(e.chips)&&e.chips>0?!1:!0},this.updateStages=function(e,s){var t=function(e){for(var s=[],t=self.arrayOfParentsOfStageAndOfContainerArray[e].stage.canvas.id,a=0;a<self.arrayOfParentsOfStageAndOfContainerArray.length;a++)self.arrayOfParentsOfStageAndOfContainerArray[a].stage.canvas.id===t&&s.push(a);return s},a=function(e,s){if(!s)var s={};if(s.upToDate!==!0&&s.uptoDate!==!1&&(s.upToDate=!1),_.isNumber(e)&&(self.arrayOfParentsOfStageAndOfContainerArray[e].upToDate=s.upToDate),_.isArray(e))for(var t=0;t<e.length;t++)self.arrayOfParentsOfStageAndOfContainerArray[e[t]].upToDate=s.upToDate},i=function(e,s){if(!s)var s={};if(0!=e.length){var i=function(e,s){return e-s};e.sort(i);for(var n=[],l=[],o=null,r=0;r<e.length;r++)self.arrayOfParentsOfStageAndOfContainerArray[e[r]].stage.canvas.id!==o&&s.clear!==!1&&(o=self.arrayOfParentsOfStageAndOfContainerArray[e[r]].stage.canvas.id,n.push(o),self.arrayOfParentsOfStageAndOfContainerArray[e[r]].stage.clear(),self.performance.numCanvasClears++,a(t(e[r]))),(self.arrayOfParentsOfStageAndOfContainerArray[e[r]].upToDate!==!0||s.forceUpdate===!0)&&(l.push(e[r]),self.arrayOfParentsOfStageAndOfContainerArray[e[r]].stage.update(),self.arrayOfParentsOfStageAndOfContainerArray[e[r]].upToDate=!0);if(n.length+l.length>0&&0===self.performance.numCanvasClears%50){var h="canvases cleared: "+n.toString()+", total cleared: "+self.performance.numCanvasClears+", stages updated: "+l.toString();console.log(h)}}};if(!s)var s={};if(_.isNumber(e)){if(this.arrayOfParentsOfStageAndOfContainerArray[e].upToDate!==!0||s.forceUpdate===!0){var n=t(e);i(n)}}else if(_.isArray(e)){if(0===e.length)return"updatestages passed 0 length array as parameter";e=_.flatten(e),e=_.without(e,null,void 0,!1,!0,{}),e=_.uniq(e);for(var l=e.length,o=0;l>o;o++)e.push(t(e[o]));e=_.flatten(e),e=_.uniq(e),i(e)}else{console.log("updating all stages");for(var r=[],o=0;o<this.arrayOfParentsOfStageAndOfContainerArray.length;o++)r.push(o);i(r)}},this.displayInitialTableState=function(e){function s(){0==i%a&&(self.images.imageLoading.title.text.text=self.images.imageLoading.title.text.text+".");var t=function(){for(var s=0;s<e.max_players;s++)if(1!=n[s]){var t=self.images.seats[s].seat.position.z.stage,a=self.images.seats[s].seat.position.z.container;(self.arrayOfParentsOfStageAndOfContainerArray[t].containers[a].contains(self.images.seats[s].seat.image)||self.arrayOfParentsOfStageAndOfContainerArray[t].containers[a].contains(self.images.seats[s].disabledSeat.image)||self.arrayOfParentsOfStageAndOfContainerArray[t].containers[a].contains(self.images.seats[s].openSeat.image))&&(n[s]=!0)}},l=function(){for(var s=0;s<e.max_players;s++)if(1!=n[s])return!1;return!0};if(t(),1==l()){createjs.Ticker.removeEventListener("tick",s);var o=self.arrayOfParentsOfStageAndOfContainerArray[self.gameState.zPositionData.loadingBackground.stage];o.stage.removeAllChildren(),self.updateStages(self.gameState.zPositionData.loadingBackground.stage),console.log("loading canvas now"),$(o.stage.canvas).css("display","none")}console.log("increasing tick"),i++}var t=5,a=1,i=0;createjs.Ticker.addEventListener("tick",s),createjs.Ticker.setInterval(t),createjs.Ticker.setPaused(!1);var n=[];self.images.imageLoading.title.text.text=self.images.imageLoading.title.text.text+".",this.updateStages(this.images.imageLoading.title.position.z.stage),this.displayChildren(this.images.getChips),this.displayChildren(this.images.table),this.displayChildren(this.images.showTableChatFull),this.displayChildren(this.images.standUp),this.displayChildren(this.images.exitTable),this.images.currencyDisplay.text.text="1 chip is equal to "+e.currency_per_chip+" "+e.currency,this.images.currencyDisplay.text.text=this.images.currencyDisplay.text.text.substring(0,this.images.currencyDisplay.text.text.length-1),this.displayChildren(this.images.currencyDisplay),this.setNumberOfSeats(e.max_players),this.displayAllCommunity(e.community);for(var l=0;l<e.seats.length;l++)if(1==e.seats[l].is_you){if(this.gameState.userSeatNumber=e.seats[l].seat,e.seats[l].flags&&_.isObject(e.seats[l].flags.sessionPreferences)){var o=e.seats[l].flags.sessionPreferences;this.updatePreference(this.sessionPreferences,o)}if(_.isObject(e.seats[l].userPreferences)){var r=e.seats[l].userPreferences;this.updatePreference(this.permanentPreferences,r)}l=9999,this.initializeServerPreferenceObjects(this.sessionPreferences,function(e){self.saveSessionPreferences(e,{})})}console.log(this.sessionPreferences);for(var l=0;l<e.seats.length;l++)self.playerSits(e.seats[l].seat,e.seats[l].username,e.seats[l].chips),self.updateLocalGameDataBasedOnServerPlayerObject(e.seats[l]),1==e.seats[l].is_you?(self.events.rotateSeatsIfNeededAndConfirm(),console.log("calling display seated options")):1==e.seats[l].sitting_out&&self.playerSitsOut(e.seats[l].seat);_.isNumber(this.gameState.userSeatNumber)||this.displayChildren(this.images.getChipsDisabledShape);for(var l=0;l<e.players.length;l+=1)e.players[l].hand&&0!=e.players[l].hand.length?e.players[l].hand&&this.displayHoleCards(e.players[l].hand,e.players[l].seat):this.displayHiddenCards(e.players[l].seat);e.pot&&e.pot>0&&this.updatePotSize(e.pot);for(var l=0;l<e.players.length;l+=1)this.playerPutsChipsInPot(e.players[l].seat,e.players[l].current_bet,e.players[l].chips),this.displayChipStack(e.players[l].current_bet,self.images.seats[e.players[l].seat],self.images.seats[e.players[l].seat].firstChip.position.x,self.images.seats[e.players[l].seat].firstChip.position.y);for(var l=0;l<e.max_players;l++)this.displayCorrectSeatMessage(l);self.gameState.bigBlind=e.big_blind,self.gameState.minIncrement=e.min_increment,self.gameState.cashier.currency=e.currency,self.gameState.cashier.currency_per_chip=e.currency_per_chip,this.updateUserOptionsBasedOnFlagsAndPreactions();for(var l=0;l<e.messages.length;l++)this.gameState.tableChatFull.log.push(["dealer",e.messages[l]]),this.updateTableChatFullMessageTextFromCurrentOrAdditionalData(null,{update:!0})},this.receiveTableState=function(){console.log("receiveTableState called"),socket.once("table_state",function(e){console.log("one time table_state message received"),self.displayInitialTableState(e),self.activateSockets()}),socket.emit("get_table_state")},this.activateSockets=function(){socket.on("street_ends",function(e){for(var s=0;s<self.images.seats.length;s++)self.gameState.seats[s].preActions.street={};self.streetEnds(e)}),socket.on("error",function(e,s){if(s);else{var s={};s.okay=!0}self.displayMessageBox(e,s)}),socket.on("player_gets_refund",function(e,s,t){var s=e.chips,a=e.current_bet,i=e.seat;self.playerPutsChipsInPot(i,a,s),self.displayChipStack(a,self.images.seats[i],self.images.seats[i].firstChip.position.x,self.images.seats[i].firstChip.position.y),self.updatePotSize(t)}),socket.on("community_dealt",function(e){self.dealCommunity(e)}),socket.on("hands_dealt",function(e,s){self.images.dealerButton.image.x=self.images.seats[s.dealer].dealerButton.position.x,self.images.dealerButton.image.y=self.images.seats[s.dealer].dealerButton.position.y,self.displayChildren(self.images.dealerButton);for(var t=[],a=0;a<e.length;a++)t.push(e[a].seat);self.gameState.holeCards?(self.dealHoleCards(s.small_blind_seat,t,self.gameState.holeCards),self.displayInHandOptions()):self.dealHoleCards(s.small_blind_seat,t),self.gameState.holeCards=null}),socket.on("flag_set",function(e,s){switch(console.log($("#server_values").data("table_state")),e){case"pending_sit_out":self.gameState.seats[self.gameState.userSeatNumber].flags.pending_sit_out=s;break;case"post_blind":self.gameState.seats[self.gameState.userSeatNumber].flags.post_blind=s;break;case"fold":self.gameState.seats[self.gameState.userSeatNumber].preActions.hand.fold=s;break;case"check":self.gameState.seats[self.gameState.userSeatNumber].preActions.hand.check=s;break;default:0===e.indexOf("sessionPreferences")?console.log("session preference flag received"):(console.log("display flags of player number "+self.gameState.userSeatNumber),console.log(0===e.indexOf("sessionPreferences")),console.log(self.gameState.seats[self.gameState.userSeatNumber].flags),self.gameState.seats[self.gameState.userSeatNumber].flags[e]=s)}self.updateUserOptionsBasedOnFlagsAndPreactions()}),socket.on("hole_cards_dealt",function(e){self.gameState.holeCards=e}),socket.on("player_acts",function(e,s,t){switch(self.playerActs(e.seat,s,2),t&&"check"!==s&&self.updatePotSize(t),s){case"fold":var a=createjs.Sound.createInstance(self.images.sources.foldSound);a.play(),self.hideHoleCards(e.seat),self.hideBet(e.seat),e.seat==self.gameState.userSeatNumber&&(self.hideChildren(self.images.foldToAnyBet),self.hideChildren(self.images.foldToAnyBetOn));break;case"check":var i=createjs.Sound.createInstance(self.images.sources.checkSound);i.play();break;case"bet":var n=createjs.Sound.createInstance(self.images.sources.betSound);n.play(),self.displayChipStack(e.current_bet,self.images.seats[e.seat],self.images.seats[e.seat].firstChip.position.x,self.images.seats[e.seat].firstChip.position.y),self.playerPutsChipsInPot(e.seat,e.current_bet,e.chips);break;case"call":var n=createjs.Sound.createInstance(self.images.sources.betSound);n.play(),self.displayChipStack(e.current_bet,self.images.seats[e.seat],self.images.seats[e.seat].firstChip.position.x,self.images.seats[e.seat].firstChip.position.y),self.playerPutsChipsInPot(e.seat,e.current_bet,e.chips);break;case"raise":var n=createjs.Sound.createInstance(self.images.sources.betSound);n.play(),self.displayChipStack(e.current_bet,self.images.seats[e.seat],self.images.seats[e.seat].firstChip.position.x,self.images.seats[e.seat].firstChip.position.y),self.playerPutsChipsInPot(e.seat,e.current_bet,e.chips);break;case"post_blind":var n=createjs.Sound.createInstance(self.images.sources.betSound);n.play(),self.displayChipStack(e.current_bet,self.images.seats[e.seat],self.images.seats[e.seat].firstChip.position.x,self.images.seats[e.seat].firstChip.position.y),self.playerPutsChipsInPot(e.seat,e.current_bet,e.chips)}self.gameState.seats[e.seat].toAct=!1,e.seat==self.gameState.userSeatNumber&&(self.gameState.seats[self.gameState.userSeatNumber].preActions.once={},$(self.arrayOfParentsOfStageAndOfContainerArray[self.images.betSlider.vertical.position.z.stage].stage.canvas).unbind("mousewheel"),$("#betSizeDiv").unbind("mousewheel"))}),socket.on("act_prompt",function(e,s){self.playerToAct(self.gameState.userSeatNumber,s);for(var t=0;t<e.length;t++)"undefined"!=typeof e[t].fold?self.displayButton(self.images.fold,!1,["act","fold"]):void 0!==e[t].check?self.displayButton(self.images.check,!1,["act","check"]):e[t].call?(self.images.call.text.text="Call "+e[t].call,self.displayButton(self.images.call,!1,["act","call",e[t].call])):e[t].raise?(self.displayButton(self.images.raise,"raise to "+e[t].raise[0],["act","raise",e[t].raise[0]]),self.displayBetSlider(e[t].raise[0],e[t].raise[1],1)):e[t].bet&&(self.displayButton(self.images.bet,"bet "+e[t].bet[0],["act","bet",e[t].bet[0]]),self.displayBetSlider(e[t].bet[0],e[t].bet[1],1))}),socket.on("hands_shown",function(e){for(var s=0;s<e.length;s++)self.hideHoleCards(e[s].seat),self.displayHoleCards(e[s].hand,e[s].seat)}),socket.on("update_time_to_act",function(e,s){self.gameState.seats[e].timeToActInMS=s}),socket.on("hands_shown",function(e){for(var s=0;s<e.length;s++)self.hideHoleCards(e[s].seat),self.displayHoleCards(e[s].hand,e[s].seat)}),socket.on("game_event",function(e,s){var t={};t.chatSourceType="dealer",t.message=e,t.timeStampString=s,self.updateTableChatFullMessageTextFromCurrentOrAdditionalData(t)}),socket.on("player_to_act",function(e,s){e.seat!=self.gameState.userSeatNumber&&self.playerToAct(e.seat,s)}),socket.on("notification",function(e){if("You will sit out as soon as the hand is over."==e)return null;var s={};s.seat=self.gameState.userSeatNumber,s.message=e,self.displayBubbleChat(s)}),socket.on("user_chats",function(e){if(e.message=e.message.replace(/^\s+|\s+$/g,""),/\S/.test(e.message))if(_.isNull(e.seat)||_.isUndefined(e.seat)){console.log("observer chatted");var s={};s.chatSourceType="observer",s.message=e.sender+" (obs) says: "+e.message,self.updateTableChatFullMessageTextFromCurrentOrAdditionalData(s)}else{console.log("seated player chatted");var s={};s.chatSourceType="player",s.message=e.sender+" says: "+e.message,self.updateTableChatFullMessageTextFromCurrentOrAdditionalData(s),self.displayBubbleChat(e)}}),socket.on("player_sits_in",function(e){self.images.seats[e.seat].status.text.text=e.chips,e.seat==self.gameState.userSeatNumber&&(self.updateLocalGameDataBasedOnServerPlayerObject(e),self.updateUserOptionsBasedOnFlagsAndPreactions()),self.updateStages(self.images.seats[e.seat].status.position.z.stage)}),socket.on("player_sits_out",function(e){self.images.seats[e.seat].status.text.text="Sitting Out",self.updateStages(self.images.seats[e.seat].status.position.z.stage),e.seat==self.gameState.userSeatNumber&&(self.updateLocalGameDataBasedOnServerPlayerObject(e),self.updateUserOptionsBasedOnFlagsAndPreactions())}),socket.on("player_sits",function(e,s){if(1==s){self.gameState.userSeatNumber=e.seat,self.events.rotateSeatsIfNeededAndConfirm(),socket.emit("get_add_chips_info"),self.updateUserOptionsBasedOnFlagsAndPreactions();for(var t=0;t<self.gameState.numSeats;t++)self.displayCorrectSeatMessage(t)}self.playerSits(e.seat,e.username,e.chips)}),socket.on("player_stands",function(e,s,t){t&&(self.gameState.userSeatNumber=!1,self.hideSeatedOptions(),self.changeUserSeatView()),self.playerStands(s)}),socket.on("player_sits_out",function(e){self.playerSitsOut(e.seat)}),socket.on("add_chips_info",function(e){self.displayCashier(e)}),socket.on("player_sets_flag",function(){}),socket.on("player_adds_chips",function(e,s){var t={};t.update=!1;var a=[];1==s&&(e.seat=self.gameState.userSeatNumber),1==e.sitting_out?a.push(self.playerSitsOut(e.seat,t)):e.chips>0&&self.images.seats[e.seat].status.text.text+""!=e.chips+""&&(self.images.seats[e.seat].status.text.text=e.chips,a.push(self.images.seats[e.seat].status.position.z.stage)),s&&(a.push(self.hideCashier(t)),e.chips>0&&(a.push(self.hideChildren(self.images.rebuy,t)),1==e.sitting_out&&a.push(self.displayChildren(self.images.sitIn,t)))),self.updateStages(a)}),socket.on("winners",function(e){self.winners(e)}),socket.on("reset_table",function(){var e={};e.update=!1;var s=[];s.push(self.roundEnds());for(var t=0;t<self.images.seats.length;t++)self.gameState.seats[t].preActions.street={},self.gameState.seats[t].preActions.hand={},s.push(self.hideChildren(self.images.seats[t].hiddenCard0,e)),s.push(self.hideChildren(self.images.seats[t].hiddenCard1,e)),s.push(self.hideChildren(self.images.seats[t].shownCard0,e)),s.push(self.hideChildren(self.images.seats[t].shownCard1,e));s.push(self.hideChildren(self.images.community,e)),s.push(self.updateUserOptionsBasedOnFlagsAndPreactions(e)),self.updateStages(s)})}}$("#chat_table").css("display","none"),$("#chat_table").css("top","1000px"),window.onKeydown=onKeyDown,jQuery(document).ready(function(){}),jQuery(window).load(function(){console.log("window load function claled"),console.log($("#server_values").data("table_state")),holdemCanvas=new Table,holdemCanvas.updatePreference(holdemCanvas.permanentPreferences,holdemCanvas.getPermanentPreferences()),holdemCanvas.initialize(),console.log(document),console.log(holdemCanvas.images.seats)});